   1               		.file	"action_tapping.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   7               		.text
   8               	.Ltext0:
   9               		.cfi_sections	.debug_frame
  10               		.section	.text.debug_waiting_buffer,"ax",@progbits
  12               	debug_waiting_buffer:
  13               	.LFB12:
  14               		.file 1 "./tmk_core/common/action_tapping.c"
   1:./tmk_core/common/action_tapping.c **** #include <stdint.h>
   2:./tmk_core/common/action_tapping.c **** #include <stdbool.h>
   3:./tmk_core/common/action_tapping.c **** #include "action.h"
   4:./tmk_core/common/action_tapping.c **** #include "action_layer.h"
   5:./tmk_core/common/action_tapping.c **** #include "action_tapping.h"
   6:./tmk_core/common/action_tapping.c **** #include "keycode.h"
   7:./tmk_core/common/action_tapping.c **** #include "timer.h"
   8:./tmk_core/common/action_tapping.c **** 
   9:./tmk_core/common/action_tapping.c **** #ifdef DEBUG_ACTION
  10:./tmk_core/common/action_tapping.c **** #include "debug.h"
  11:./tmk_core/common/action_tapping.c **** #else
  12:./tmk_core/common/action_tapping.c **** #include "nodebug.h"
  13:./tmk_core/common/action_tapping.c **** #endif
  14:./tmk_core/common/action_tapping.c **** 
  15:./tmk_core/common/action_tapping.c **** #ifndef NO_ACTION_TAPPING
  16:./tmk_core/common/action_tapping.c **** 
  17:./tmk_core/common/action_tapping.c **** #define IS_TAPPING()            !IS_NOEVENT(tapping_key.event)
  18:./tmk_core/common/action_tapping.c **** #define IS_TAPPING_PRESSED()    (IS_TAPPING() && tapping_key.event.pressed)
  19:./tmk_core/common/action_tapping.c **** #define IS_TAPPING_RELEASED()   (IS_TAPPING() && !tapping_key.event.pressed)
  20:./tmk_core/common/action_tapping.c **** #define IS_TAPPING_KEY(k)       (IS_TAPPING() && KEYEQ(tapping_key.event.key, (k)))
  21:./tmk_core/common/action_tapping.c **** #define WITHIN_TAPPING_TERM(e)  (TIMER_DIFF_16(e.time, tapping_key.event.time) < TAPPING_TERM)
  22:./tmk_core/common/action_tapping.c **** 
  23:./tmk_core/common/action_tapping.c **** 
  24:./tmk_core/common/action_tapping.c **** static keyrecord_t tapping_key = {};
  25:./tmk_core/common/action_tapping.c **** static keyrecord_t waiting_buffer[WAITING_BUFFER_SIZE] = {};
  26:./tmk_core/common/action_tapping.c **** static uint8_t waiting_buffer_head = 0;
  27:./tmk_core/common/action_tapping.c **** static uint8_t waiting_buffer_tail = 0;
  28:./tmk_core/common/action_tapping.c **** 
  29:./tmk_core/common/action_tapping.c **** static bool process_tapping(keyrecord_t *record);
  30:./tmk_core/common/action_tapping.c **** static bool waiting_buffer_enq(keyrecord_t record);
  31:./tmk_core/common/action_tapping.c **** static void waiting_buffer_clear(void);
  32:./tmk_core/common/action_tapping.c **** static bool waiting_buffer_typed(keyevent_t event);
  33:./tmk_core/common/action_tapping.c **** static bool waiting_buffer_has_anykey_pressed(void);
  34:./tmk_core/common/action_tapping.c **** static void waiting_buffer_scan_tap(void);
  35:./tmk_core/common/action_tapping.c **** static void debug_tapping_key(void);
  36:./tmk_core/common/action_tapping.c **** static void debug_waiting_buffer(void);
  37:./tmk_core/common/action_tapping.c **** 
  38:./tmk_core/common/action_tapping.c **** 
  39:./tmk_core/common/action_tapping.c **** void action_tapping_process(keyrecord_t record)
  40:./tmk_core/common/action_tapping.c **** {
  41:./tmk_core/common/action_tapping.c ****     if (process_tapping(&record)) {
  42:./tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
  43:./tmk_core/common/action_tapping.c ****             debug("processed: "); debug_record(record); debug("\n");
  44:./tmk_core/common/action_tapping.c ****         }
  45:./tmk_core/common/action_tapping.c ****     } else {
  46:./tmk_core/common/action_tapping.c ****         if (!waiting_buffer_enq(record)) {
  47:./tmk_core/common/action_tapping.c ****             // clear all in case of overflow.
  48:./tmk_core/common/action_tapping.c ****             debug("OVERFLOW: CLEAR ALL STATES\n");
  49:./tmk_core/common/action_tapping.c ****             clear_keyboard();
  50:./tmk_core/common/action_tapping.c ****             waiting_buffer_clear();
  51:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
  52:./tmk_core/common/action_tapping.c ****         }
  53:./tmk_core/common/action_tapping.c ****     }
  54:./tmk_core/common/action_tapping.c **** 
  55:./tmk_core/common/action_tapping.c ****     // process waiting_buffer
  56:./tmk_core/common/action_tapping.c ****     if (!IS_NOEVENT(record.event) && waiting_buffer_head != waiting_buffer_tail) {
  57:./tmk_core/common/action_tapping.c ****         debug("---- action_exec: process waiting_buffer -----\n");
  58:./tmk_core/common/action_tapping.c ****     }
  59:./tmk_core/common/action_tapping.c ****     for (; waiting_buffer_tail != waiting_buffer_head; waiting_buffer_tail = (waiting_buffer_tail +
  60:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
  61:./tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
  62:./tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
  63:./tmk_core/common/action_tapping.c ****         } else {
  64:./tmk_core/common/action_tapping.c ****             break;
  65:./tmk_core/common/action_tapping.c ****         }
  66:./tmk_core/common/action_tapping.c ****     }
  67:./tmk_core/common/action_tapping.c ****     if (!IS_NOEVENT(record.event)) {
  68:./tmk_core/common/action_tapping.c ****         debug("\n");
  69:./tmk_core/common/action_tapping.c ****     }
  70:./tmk_core/common/action_tapping.c **** }
  71:./tmk_core/common/action_tapping.c **** 
  72:./tmk_core/common/action_tapping.c **** 
  73:./tmk_core/common/action_tapping.c **** /* Tapping
  74:./tmk_core/common/action_tapping.c ****  *
  75:./tmk_core/common/action_tapping.c ****  * Rule: Tap key is typed(pressed and released) within TAPPING_TERM.
  76:./tmk_core/common/action_tapping.c ****  *       (without interfering by typing other key)
  77:./tmk_core/common/action_tapping.c ****  */
  78:./tmk_core/common/action_tapping.c **** /* return true when key event is processed or consumed. */
  79:./tmk_core/common/action_tapping.c **** bool process_tapping(keyrecord_t *keyp)
  80:./tmk_core/common/action_tapping.c **** {
  81:./tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
  82:./tmk_core/common/action_tapping.c **** 
  83:./tmk_core/common/action_tapping.c ****     // if tapping
  84:./tmk_core/common/action_tapping.c ****     if (IS_TAPPING_PRESSED()) {
  85:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
  86:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
  87:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
  88:./tmk_core/common/action_tapping.c ****                     // first tap!
  89:./tmk_core/common/action_tapping.c ****                     debug("Tapping: First tap(0->1).\n");
  90:./tmk_core/common/action_tapping.c ****                     tapping_key.tap.count = 1;
  91:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
  92:./tmk_core/common/action_tapping.c ****                     process_record(&tapping_key);
  93:./tmk_core/common/action_tapping.c **** 
  94:./tmk_core/common/action_tapping.c ****                     // copy tapping state
  95:./tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
  96:./tmk_core/common/action_tapping.c ****                     // enqueue
  97:./tmk_core/common/action_tapping.c ****                     return false;
  98:./tmk_core/common/action_tapping.c ****                 }
  99:./tmk_core/common/action_tapping.c **** #if TAPPING_TERM >= 500
 100:./tmk_core/common/action_tapping.c ****                 /* Process a key typed within TAPPING_TERM
 101:./tmk_core/common/action_tapping.c ****                  * This can register the key before settlement of tapping,
 102:./tmk_core/common/action_tapping.c ****                  * useful for long TAPPING_TERM but may prevent fast typing.
 103:./tmk_core/common/action_tapping.c ****                  */
 104:./tmk_core/common/action_tapping.c ****                 else if (IS_RELEASED(event) && waiting_buffer_typed(event)) {
 105:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. No tap. Interfered by typing key\n");
 106:./tmk_core/common/action_tapping.c ****                     process_record(&tapping_key);
 107:./tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 108:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 109:./tmk_core/common/action_tapping.c ****                     // enqueue
 110:./tmk_core/common/action_tapping.c ****                     return false;
 111:./tmk_core/common/action_tapping.c ****                 }
 112:./tmk_core/common/action_tapping.c **** #endif
 113:./tmk_core/common/action_tapping.c ****                 /* Process release event of a key pressed before tapping starts
 114:./tmk_core/common/action_tapping.c ****                  * Without this unexpected repeating will occur with having fast repeating setting
 115:./tmk_core/common/action_tapping.c ****                  * https://github.com/tmk/tmk_keyboard/issues/60
 116:./tmk_core/common/action_tapping.c ****                  */
 117:./tmk_core/common/action_tapping.c ****                 else if (IS_RELEASED(event) && !waiting_buffer_typed(event)) {
 118:./tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 119:./tmk_core/common/action_tapping.c ****                     action_t action = layer_switch_get_action(event.key);
 120:./tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 121:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 122:./tmk_core/common/action_tapping.c ****                         case ACT_RMODS:
 123:./tmk_core/common/action_tapping.c ****                             if (action.key.mods && !action.key.code) return false;
 124:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 125:./tmk_core/common/action_tapping.c ****                             break;
 126:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS_TAP:
 127:./tmk_core/common/action_tapping.c ****                         case ACT_RMODS_TAP:
 128:./tmk_core/common/action_tapping.c ****                             if (action.key.mods && keyp->tap.count == 0) return false;
 129:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 130:./tmk_core/common/action_tapping.c ****                             break;
 131:./tmk_core/common/action_tapping.c ****                     }
 132:./tmk_core/common/action_tapping.c ****                     // Release of key should be process immediately.
 133:./tmk_core/common/action_tapping.c ****                     debug("Tapping: release event of a key pressed before tapping\n");
 134:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 135:./tmk_core/common/action_tapping.c ****                     return true;
 136:./tmk_core/common/action_tapping.c ****                 }
 137:./tmk_core/common/action_tapping.c ****                 else {
 138:./tmk_core/common/action_tapping.c ****                     // set interrupted flag when other key preesed during tapping
 139:./tmk_core/common/action_tapping.c ****                     if (event.pressed) {
 140:./tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 141:./tmk_core/common/action_tapping.c ****                     }
 142:./tmk_core/common/action_tapping.c ****                     // enqueue
 143:./tmk_core/common/action_tapping.c ****                     return false;
 144:./tmk_core/common/action_tapping.c ****                 }
 145:./tmk_core/common/action_tapping.c ****             }
 146:./tmk_core/common/action_tapping.c ****             // tap_count > 0
 147:./tmk_core/common/action_tapping.c ****             else {
 148:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 149:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 150:./tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 151:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 152:./tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 153:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 154:./tmk_core/common/action_tapping.c ****                     return true;
 155:./tmk_core/common/action_tapping.c ****                 }
 156:./tmk_core/common/action_tapping.c ****                 else if (is_tap_key(event.key) && event.pressed) {
 157:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 158:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 159:./tmk_core/common/action_tapping.c ****                         // unregister key
 160:./tmk_core/common/action_tapping.c ****                         process_record(&(keyrecord_t){
 161:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 162:./tmk_core/common/action_tapping.c ****                                 .event.key = tapping_key.event.key,
 163:./tmk_core/common/action_tapping.c ****                                 .event.time = event.time,
 164:./tmk_core/common/action_tapping.c ****                                 .event.pressed = false
 165:./tmk_core/common/action_tapping.c ****                         });
 166:./tmk_core/common/action_tapping.c ****                     } else {
 167:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start while last tap(1).\n");
 168:./tmk_core/common/action_tapping.c ****                     }
 169:./tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 170:./tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 171:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 172:./tmk_core/common/action_tapping.c ****                     return true;
 173:./tmk_core/common/action_tapping.c ****                 }
 174:./tmk_core/common/action_tapping.c ****                 else {
 175:./tmk_core/common/action_tapping.c ****                     if (!IS_NOEVENT(event)) {
 176:./tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last tap(>0).\n");
 177:./tmk_core/common/action_tapping.c ****                     }
 178:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 179:./tmk_core/common/action_tapping.c ****                     return true;
 180:./tmk_core/common/action_tapping.c ****                 }
 181:./tmk_core/common/action_tapping.c ****             }
 182:./tmk_core/common/action_tapping.c ****         }
 183:./tmk_core/common/action_tapping.c ****         // after TAPPING_TERM
 184:./tmk_core/common/action_tapping.c ****         else {
 185:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 186:./tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 187:./tmk_core/common/action_tapping.c ****                 debug_event(event); debug("\n");
 188:./tmk_core/common/action_tapping.c ****                 process_record(&tapping_key);
 189:./tmk_core/common/action_tapping.c ****                 tapping_key = (keyrecord_t){};
 190:./tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 191:./tmk_core/common/action_tapping.c ****                 return false;
 192:./tmk_core/common/action_tapping.c ****             }  else {
 193:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 194:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 195:./tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 196:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 197:./tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 198:./tmk_core/common/action_tapping.c ****                     return true;
 199:./tmk_core/common/action_tapping.c ****                 }
 200:./tmk_core/common/action_tapping.c ****                 else if (is_tap_key(event.key) && event.pressed) {
 201:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 202:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 203:./tmk_core/common/action_tapping.c ****                         // unregister key
 204:./tmk_core/common/action_tapping.c ****                         process_record(&(keyrecord_t){
 205:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 206:./tmk_core/common/action_tapping.c ****                                 .event.key = tapping_key.event.key,
 207:./tmk_core/common/action_tapping.c ****                                 .event.time = event.time,
 208:./tmk_core/common/action_tapping.c ****                                 .event.pressed = false
 209:./tmk_core/common/action_tapping.c ****                         });
 210:./tmk_core/common/action_tapping.c ****                     } else {
 211:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start while last timeout tap(1).\n");
 212:./tmk_core/common/action_tapping.c ****                     }
 213:./tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 214:./tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 215:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 216:./tmk_core/common/action_tapping.c ****                     return true;
 217:./tmk_core/common/action_tapping.c ****                 }
 218:./tmk_core/common/action_tapping.c ****                 else {
 219:./tmk_core/common/action_tapping.c ****                     if (!IS_NOEVENT(event)) {
 220:./tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last timeout tap(>0).\n");
 221:./tmk_core/common/action_tapping.c ****                     }
 222:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 223:./tmk_core/common/action_tapping.c ****                     return true;
 224:./tmk_core/common/action_tapping.c ****                 }
 225:./tmk_core/common/action_tapping.c ****             }
 226:./tmk_core/common/action_tapping.c ****         }
 227:./tmk_core/common/action_tapping.c ****     } else if (IS_TAPPING_RELEASED()) {
 228:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 229:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 230:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 231:./tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 232:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 233:./tmk_core/common/action_tapping.c ****                         keyp->tap = tapping_key.tap;
 234:./tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 235:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 236:./tmk_core/common/action_tapping.c ****                         process_record(keyp);
 237:./tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 238:./tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 239:./tmk_core/common/action_tapping.c ****                         return true;
 240:./tmk_core/common/action_tapping.c ****                     } else {
 241:./tmk_core/common/action_tapping.c ****                         // FIX: start new tap again
 242:./tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 243:./tmk_core/common/action_tapping.c ****                         return true;
 244:./tmk_core/common/action_tapping.c ****                     }
 245:./tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event.key)) {
 246:./tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 247:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Start with interfering other tap.\n");
 248:./tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 249:./tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 250:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 251:./tmk_core/common/action_tapping.c ****                     return true;
 252:./tmk_core/common/action_tapping.c ****                 } else {
 253:./tmk_core/common/action_tapping.c ****                     // should none in buffer
 254:./tmk_core/common/action_tapping.c ****                     // FIX: interrupted when other key is pressed
 255:./tmk_core/common/action_tapping.c ****                     tapping_key.tap.interrupted = true;
 256:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 257:./tmk_core/common/action_tapping.c ****                     return true;
 258:./tmk_core/common/action_tapping.c ****                 }
 259:./tmk_core/common/action_tapping.c ****             } else {
 260:./tmk_core/common/action_tapping.c ****                 if (!IS_NOEVENT(event)) debug("Tapping: other key just after tap.\n") {};
 261:./tmk_core/common/action_tapping.c ****                 process_record(keyp);
 262:./tmk_core/common/action_tapping.c ****                 return true;
 263:./tmk_core/common/action_tapping.c ****             }
 264:./tmk_core/common/action_tapping.c ****         } else {
 265:./tmk_core/common/action_tapping.c ****             // FIX: process_aciton here?
 266:./tmk_core/common/action_tapping.c ****             // timeout. no sequential tap.
 267:./tmk_core/common/action_tapping.c ****             debug("Tapping: End(Timeout after releasing last tap): ");
 268:./tmk_core/common/action_tapping.c ****             debug_event(event); debug("\n");
 269:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 270:./tmk_core/common/action_tapping.c ****             debug_tapping_key();
 271:./tmk_core/common/action_tapping.c ****             return false;
 272:./tmk_core/common/action_tapping.c ****         }
 273:./tmk_core/common/action_tapping.c ****     }
 274:./tmk_core/common/action_tapping.c ****     // not tapping state
 275:./tmk_core/common/action_tapping.c ****     else {
 276:./tmk_core/common/action_tapping.c ****         if (event.pressed && is_tap_key(event.key)) {
 277:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 278:./tmk_core/common/action_tapping.c ****             tapping_key = *keyp;
 279:./tmk_core/common/action_tapping.c ****             waiting_buffer_scan_tap();
 280:./tmk_core/common/action_tapping.c ****             debug_tapping_key();
 281:./tmk_core/common/action_tapping.c ****             return true;
 282:./tmk_core/common/action_tapping.c ****         } else {
 283:./tmk_core/common/action_tapping.c ****             process_record(keyp);
 284:./tmk_core/common/action_tapping.c ****             return true;
 285:./tmk_core/common/action_tapping.c ****         }
 286:./tmk_core/common/action_tapping.c ****     }
 287:./tmk_core/common/action_tapping.c **** }
 288:./tmk_core/common/action_tapping.c **** 
 289:./tmk_core/common/action_tapping.c **** 
 290:./tmk_core/common/action_tapping.c **** /*
 291:./tmk_core/common/action_tapping.c ****  * Waiting buffer
 292:./tmk_core/common/action_tapping.c ****  */
 293:./tmk_core/common/action_tapping.c **** bool waiting_buffer_enq(keyrecord_t record)
 294:./tmk_core/common/action_tapping.c **** {
 295:./tmk_core/common/action_tapping.c ****     if (IS_NOEVENT(record.event)) {
 296:./tmk_core/common/action_tapping.c ****         return true;
 297:./tmk_core/common/action_tapping.c ****     }
 298:./tmk_core/common/action_tapping.c **** 
 299:./tmk_core/common/action_tapping.c ****     if ((waiting_buffer_head + 1) % WAITING_BUFFER_SIZE == waiting_buffer_tail) {
 300:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 301:./tmk_core/common/action_tapping.c ****         return false;
 302:./tmk_core/common/action_tapping.c ****     }
 303:./tmk_core/common/action_tapping.c **** 
 304:./tmk_core/common/action_tapping.c ****     waiting_buffer[waiting_buffer_head] = record;
 305:./tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 306:./tmk_core/common/action_tapping.c **** 
 307:./tmk_core/common/action_tapping.c ****     debug("waiting_buffer_enq: "); debug_waiting_buffer();
 308:./tmk_core/common/action_tapping.c ****     return true;
 309:./tmk_core/common/action_tapping.c **** }
 310:./tmk_core/common/action_tapping.c **** 
 311:./tmk_core/common/action_tapping.c **** void waiting_buffer_clear(void)
 312:./tmk_core/common/action_tapping.c **** {
 313:./tmk_core/common/action_tapping.c ****     waiting_buffer_head = 0;
 314:./tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 315:./tmk_core/common/action_tapping.c **** }
 316:./tmk_core/common/action_tapping.c **** 
 317:./tmk_core/common/action_tapping.c **** bool waiting_buffer_typed(keyevent_t event)
 318:./tmk_core/common/action_tapping.c **** {
 319:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 320:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 321:./tmk_core/common/action_tapping.c ****             return true;
 322:./tmk_core/common/action_tapping.c ****         }
 323:./tmk_core/common/action_tapping.c ****     }
 324:./tmk_core/common/action_tapping.c ****     return false;
 325:./tmk_core/common/action_tapping.c **** }
 326:./tmk_core/common/action_tapping.c **** 
 327:./tmk_core/common/action_tapping.c **** __attribute__((unused))
 328:./tmk_core/common/action_tapping.c **** bool waiting_buffer_has_anykey_pressed(void)
 329:./tmk_core/common/action_tapping.c **** {
 330:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 331:./tmk_core/common/action_tapping.c ****         if (waiting_buffer[i].event.pressed) return true;
 332:./tmk_core/common/action_tapping.c ****     }
 333:./tmk_core/common/action_tapping.c ****     return false;
 334:./tmk_core/common/action_tapping.c **** }
 335:./tmk_core/common/action_tapping.c **** 
 336:./tmk_core/common/action_tapping.c **** /* scan buffer for tapping */
 337:./tmk_core/common/action_tapping.c **** void waiting_buffer_scan_tap(void)
 338:./tmk_core/common/action_tapping.c **** {
 339:./tmk_core/common/action_tapping.c ****     // tapping already is settled
 340:./tmk_core/common/action_tapping.c ****     if (tapping_key.tap.count > 0) return;
 341:./tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 342:./tmk_core/common/action_tapping.c ****     if (!tapping_key.event.pressed) return;
 343:./tmk_core/common/action_tapping.c **** 
 344:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 345:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 346:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 347:./tmk_core/common/action_tapping.c ****                 WITHIN_TAPPING_TERM(waiting_buffer[i].event)) {
 348:./tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 349:./tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 350:./tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 351:./tmk_core/common/action_tapping.c **** 
 352:./tmk_core/common/action_tapping.c ****             debug("waiting_buffer_scan_tap: found at ["); debug_dec(i); debug("]\n");
 353:./tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 354:./tmk_core/common/action_tapping.c ****             return;
 355:./tmk_core/common/action_tapping.c ****         }
 356:./tmk_core/common/action_tapping.c ****     }
 357:./tmk_core/common/action_tapping.c **** }
 358:./tmk_core/common/action_tapping.c **** 
 359:./tmk_core/common/action_tapping.c **** 
 360:./tmk_core/common/action_tapping.c **** /*
 361:./tmk_core/common/action_tapping.c ****  * debug print
 362:./tmk_core/common/action_tapping.c ****  */
 363:./tmk_core/common/action_tapping.c **** static void debug_tapping_key(void)
 364:./tmk_core/common/action_tapping.c **** {
 365:./tmk_core/common/action_tapping.c ****     debug("TAPPING_KEY="); debug_record(tapping_key); debug("\n");
 366:./tmk_core/common/action_tapping.c **** }
 367:./tmk_core/common/action_tapping.c **** 
 368:./tmk_core/common/action_tapping.c **** static void debug_waiting_buffer(void)
 369:./tmk_core/common/action_tapping.c **** {
  15               		.loc 1 369 1 view -0
  16               		.cfi_startproc
  17 0000 1F93      		push r17
  18               	.LCFI0:
  19               		.cfi_def_cfa_offset 3
  20               		.cfi_offset 17, -2
  21 0002 CF93      		push r28
  22               	.LCFI1:
  23               		.cfi_def_cfa_offset 4
  24               		.cfi_offset 28, -3
  25 0004 DF93      		push r29
  26               	.LCFI2:
  27               		.cfi_def_cfa_offset 5
  28               		.cfi_offset 29, -4
  29               	/* prologue: function */
  30               	/* frame size = 0 */
  31               	/* stack size = 3 */
  32               	.L__stack_usage = 3
 370:./tmk_core/common/action_tapping.c ****     debug("{ ");
  33               		.loc 1 370 16 view .LVU1
 371:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  34               		.loc 1 371 5 view .LVU2
  35               	.LBB3:
  36               		.loc 1 371 10 view .LVU3
  37               		.loc 1 371 18 is_stmt 0 view .LVU4
  38 0006 E091 0000 		lds r30,waiting_buffer_tail
  39               	.LVL0:
 372:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  40               		.loc 1 372 48 view .LVU5
  41 000a 16E0      		ldi r17,lo8(6)
  42               	.LVL1:
  43               	.L2:
 371:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  44               		.loc 1 371 43 is_stmt 1 discriminator 1 view .LVU6
 371:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  45               		.loc 1 371 5 is_stmt 0 discriminator 1 view .LVU7
  46 000c 8091 0000 		lds r24,waiting_buffer_head
  47 0010 8E13      		cpse r24,r30
  48 0012 00C0      		rjmp .L3
  49               	/* epilogue start */
  50               	.LBE3:
 373:./tmk_core/common/action_tapping.c ****     }
 374:./tmk_core/common/action_tapping.c ****     debug("}\n");
 375:./tmk_core/common/action_tapping.c **** }
  51               		.loc 1 375 1 view .LVU8
  52 0014 DF91      		pop r29
  53 0016 CF91      		pop r28
  54 0018 1F91      		pop r17
  55 001a 0895      		ret
  56               	.L3:
  57               	.LBB4:
 372:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  58               		.loc 1 372 19 is_stmt 1 discriminator 3 view .LVU9
 372:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  59               		.loc 1 372 33 discriminator 3 view .LVU10
 372:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  60               		.loc 1 372 46 discriminator 3 view .LVU11
 372:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  61               		.loc 1 372 48 discriminator 3 view .LVU12
  62 001c CE2F      		mov r28,r30
  63 001e D0E0      		ldi r29,0
  64 0020 1E9F      		mul r17,r30
  65 0022 F001      		movw r30,r0
  66 0024 1124      		clr __zero_reg__
  67               	.LVL2:
 372:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  68               		.loc 1 372 48 is_stmt 0 discriminator 3 view .LVU13
  69 0026 E050      		subi r30,lo8(-(waiting_buffer))
  70 0028 F040      		sbci r31,hi8(-(waiting_buffer))
  71 002a 4081      		ld r20,Z
  72 002c 5181      		ldd r21,Z+1
  73 002e 6281      		ldd r22,Z+2
  74 0030 7381      		ldd r23,Z+3
  75 0032 8481      		ldd r24,Z+4
  76 0034 9581      		ldd r25,Z+5
  77 0036 0E94 0000 		call debug_record
  78               	.LVL3:
 372:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  79               		.loc 1 372 91 is_stmt 1 discriminator 3 view .LVU14
 371:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  80               		.loc 1 371 69 discriminator 3 view .LVU15
 371:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  81               		.loc 1 371 76 is_stmt 0 discriminator 3 view .LVU16
  82 003a FE01      		movw r30,r28
  83 003c 3196      		adiw r30,1
 371:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  84               		.loc 1 371 71 discriminator 3 view .LVU17
  85 003e E770      		andi r30,lo8(7)
  86               	.LVL4:
 371:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  87               		.loc 1 371 71 discriminator 3 view .LVU18
  88 0040 00C0      		rjmp .L2
  89               	.LBE4:
  90               		.cfi_endproc
  91               	.LFE12:
  93               		.section	.text.debug_tapping_key,"ax",@progbits
  95               	debug_tapping_key:
  96               	.LFB11:
 364:./tmk_core/common/action_tapping.c ****     debug("TAPPING_KEY="); debug_record(tapping_key); debug("\n");
  97               		.loc 1 364 1 is_stmt 1 view -0
  98               		.cfi_startproc
  99               	/* prologue: function */
 100               	/* frame size = 0 */
 101               	/* stack size = 0 */
 102               	.L__stack_usage = 0
 365:./tmk_core/common/action_tapping.c **** }
 103               		.loc 1 365 26 view .LVU20
 365:./tmk_core/common/action_tapping.c **** }
 104               		.loc 1 365 28 view .LVU21
 105 0000 4091 0000 		lds r20,tapping_key
 106 0004 5091 0000 		lds r21,tapping_key+1
 107 0008 6091 0000 		lds r22,tapping_key+2
 108 000c 7091 0000 		lds r23,tapping_key+3
 109 0010 8091 0000 		lds r24,tapping_key+4
 110 0014 9091 0000 		lds r25,tapping_key+5
 111 0018 0C94 0000 		jmp debug_record
 112               	.LVL5:
 113               		.cfi_endproc
 114               	.LFE11:
 116               		.section	.text.waiting_buffer_scan_tap,"ax",@progbits
 118               	waiting_buffer_scan_tap:
 119               	.LFB10:
 338:./tmk_core/common/action_tapping.c ****     // tapping already is settled
 120               		.loc 1 338 1 view -0
 121               		.cfi_startproc
 122 0000 1F93      		push r17
 123               	.LCFI3:
 124               		.cfi_def_cfa_offset 3
 125               		.cfi_offset 17, -2
 126 0002 CF93      		push r28
 127               	.LCFI4:
 128               		.cfi_def_cfa_offset 4
 129               		.cfi_offset 28, -3
 130 0004 DF93      		push r29
 131               	.LCFI5:
 132               		.cfi_def_cfa_offset 5
 133               		.cfi_offset 29, -4
 134               	/* prologue: function */
 135               	/* frame size = 0 */
 136               	/* stack size = 3 */
 137               	.L__stack_usage = 3
 340:./tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 138               		.loc 1 340 5 view .LVU23
 340:./tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 139               		.loc 1 340 31 is_stmt 0 view .LVU24
 140 0006 8091 0000 		lds r24,tapping_key+5
 141 000a 807F      		andi r24,lo8(-16)
 340:./tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 142               		.loc 1 340 8 view .LVU25
 143 000c 01F4      		brne .L5
 342:./tmk_core/common/action_tapping.c **** 
 144               		.loc 1 342 5 is_stmt 1 view .LVU26
 342:./tmk_core/common/action_tapping.c **** 
 145               		.loc 1 342 8 is_stmt 0 view .LVU27
 146 000e 8091 0000 		lds r24,tapping_key+2
 147 0012 8823      		tst r24
 148 0014 01F0      		breq .L5
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 149               		.loc 1 344 5 is_stmt 1 view .LVU28
 150               	.LBB8:
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 151               		.loc 1 344 10 view .LVU29
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 152               		.loc 1 344 18 is_stmt 0 view .LVU30
 153 0016 8091 0000 		lds r24,waiting_buffer_tail
 154               	.LVL6:
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 155               		.loc 1 344 45 view .LVU31
 156 001a C091 0000 		lds r28,waiting_buffer_head
 345:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 157               		.loc 1 345 13 view .LVU32
 158 001e 6091 0000 		lds r22,tapping_key
 159 0022 7091 0000 		lds r23,tapping_key+1
 160 0026 4091 0000 		lds r20,tapping_key+3
 161 002a 5091 0000 		lds r21,tapping_key+3+1
 162 002e D62F      		mov r29,r22
 163 0030 D723      		and r29,r23
 164 0032 DA01      		movw r26,r20
 165 0034 A095      		com r26
 166 0036 B095      		com r27
 167 0038 16E0      		ldi r17,lo8(6)
 168               	.LVL7:
 169               	.L7:
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 170               		.loc 1 344 43 is_stmt 1 discriminator 1 view .LVU33
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 171               		.loc 1 344 5 is_stmt 0 discriminator 1 view .LVU34
 172 003a C813      		cpse r28,r24
 173 003c 00C0      		rjmp .L14
 174               	.LVL8:
 175               	.L5:
 176               	/* epilogue start */
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 177               		.loc 1 344 5 discriminator 1 view .LVU35
 178               	.LBE8:
 357:./tmk_core/common/action_tapping.c **** 
 179               		.loc 1 357 1 view .LVU36
 180 003e DF91      		pop r29
 181 0040 CF91      		pop r28
 182 0042 1F91      		pop r17
 183 0044 0895      		ret
 184               	.LVL9:
 185               	.L14:
 186               	.LBB11:
 345:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 187               		.loc 1 345 9 is_stmt 1 view .LVU37
 188               	.LBB9:
 189               	.LBI9:
 190               		.file 2 "./tmk_core/common/keyboard.h"
   1:./tmk_core/common/keyboard.h **** /*
   2:./tmk_core/common/keyboard.h **** Copyright 2011,2012,2013 Jun Wako <wakojun@gmail.com>
   3:./tmk_core/common/keyboard.h **** 
   4:./tmk_core/common/keyboard.h **** This program is free software: you can redistribute it and/or modify
   5:./tmk_core/common/keyboard.h **** it under the terms of the GNU General Public License as published by
   6:./tmk_core/common/keyboard.h **** the Free Software Foundation, either version 2 of the License, or
   7:./tmk_core/common/keyboard.h **** (at your option) any later version.
   8:./tmk_core/common/keyboard.h **** 
   9:./tmk_core/common/keyboard.h **** This program is distributed in the hope that it will be useful,
  10:./tmk_core/common/keyboard.h **** but WITHOUT ANY WARRANTY; without even the implied warranty of
  11:./tmk_core/common/keyboard.h **** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  12:./tmk_core/common/keyboard.h **** GNU General Public License for more details.
  13:./tmk_core/common/keyboard.h **** 
  14:./tmk_core/common/keyboard.h **** You should have received a copy of the GNU General Public License
  15:./tmk_core/common/keyboard.h **** along with this program.  If not, see <http://www.gnu.org/licenses/>.
  16:./tmk_core/common/keyboard.h **** */
  17:./tmk_core/common/keyboard.h **** 
  18:./tmk_core/common/keyboard.h **** #ifndef KEYBOARD_H
  19:./tmk_core/common/keyboard.h **** #define KEYBOARD_H
  20:./tmk_core/common/keyboard.h **** 
  21:./tmk_core/common/keyboard.h **** #include <stdbool.h>
  22:./tmk_core/common/keyboard.h **** #include <stdint.h>
  23:./tmk_core/common/keyboard.h **** 
  24:./tmk_core/common/keyboard.h **** 
  25:./tmk_core/common/keyboard.h **** #ifdef __cplusplus
  26:./tmk_core/common/keyboard.h **** extern "C" {
  27:./tmk_core/common/keyboard.h **** #endif
  28:./tmk_core/common/keyboard.h **** 
  29:./tmk_core/common/keyboard.h **** /* key matrix position */
  30:./tmk_core/common/keyboard.h **** typedef struct {
  31:./tmk_core/common/keyboard.h ****     uint8_t col;
  32:./tmk_core/common/keyboard.h ****     uint8_t row;
  33:./tmk_core/common/keyboard.h **** } keypos_t;
  34:./tmk_core/common/keyboard.h **** 
  35:./tmk_core/common/keyboard.h **** /* key event */
  36:./tmk_core/common/keyboard.h **** typedef struct {
  37:./tmk_core/common/keyboard.h ****     keypos_t key;
  38:./tmk_core/common/keyboard.h ****     bool     pressed;
  39:./tmk_core/common/keyboard.h ****     uint16_t time;
  40:./tmk_core/common/keyboard.h **** } keyevent_t;
  41:./tmk_core/common/keyboard.h **** 
  42:./tmk_core/common/keyboard.h **** /* equivalent test of keypos_t */
  43:./tmk_core/common/keyboard.h **** #define KEYEQ(keya, keyb)       ((keya).row == (keyb).row && (keya).col == (keyb).col)
  44:./tmk_core/common/keyboard.h **** 
  45:./tmk_core/common/keyboard.h **** /* Rules for No Event:
  46:./tmk_core/common/keyboard.h ****  * 1) (time == 0) to handle (keyevent_t){} as empty event
  47:./tmk_core/common/keyboard.h ****  * 2) Matrix(255, 255) to make TICK event available
  48:./tmk_core/common/keyboard.h ****  */
  49:./tmk_core/common/keyboard.h **** static inline bool IS_NOEVENT(keyevent_t event) { return event.time == 0 || (event.key.row == 255 &
 191               		.loc 2 49 20 view .LVU38
 192               	.LBB10:
 193               		.loc 2 49 51 view .LVU39
 194 0046 90E0      		ldi r25,0
 195               		.loc 2 49 74 is_stmt 0 view .LVU40
 196 0048 4115      		cp r20,__zero_reg__
 197 004a 5105      		cpc r21,__zero_reg__
 198 004c 01F0      		breq .L8
 199 004e DF3F      		cpi r29,lo8(-1)
 200 0050 01F4      		brne .L27
 201               	.L8:
 202               	.LBE10:
 203               	.LBE9:
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 204               		.loc 1 344 69 is_stmt 1 discriminator 2 view .LVU41
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 205               		.loc 1 344 76 is_stmt 0 discriminator 2 view .LVU42
 206 0052 0196      		adiw r24,1
 207               	.LVL10:
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 208               		.loc 1 344 71 discriminator 2 view .LVU43
 209 0054 8770      		andi r24,lo8(7)
 344:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 210               		.loc 1 344 71 discriminator 2 view .LVU44
 211 0056 00C0      		rjmp .L7
 212               	.LVL11:
 213               	.L10:
 347:./tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 214               		.loc 1 347 17 discriminator 2 view .LVU45
 215 0058 2A0F      		add r18,r26
 216 005a 3B1F      		adc r19,r27
 217 005c 00C0      		rjmp .L28
 218               	.L27:
 345:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 219               		.loc 1 345 13 view .LVU46
 220 005e 189F      		mul r17,r24
 221 0060 F001      		movw r30,r0
 222 0062 199F      		mul r17,r25
 223 0064 F00D      		add r31,r0
 224 0066 1124      		clr __zero_reg__
 225 0068 E050      		subi r30,lo8(-(waiting_buffer))
 226 006a F040      		sbci r31,hi8(-(waiting_buffer))
 227 006c 2181      		ldd r18,Z+1
 228 006e 2713      		cpse r18,r23
 229 0070 00C0      		rjmp .L8
 345:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 230               		.loc 1 345 13 discriminator 2 view .LVU47
 231 0072 2081      		ld r18,Z
 232 0074 2613      		cpse r18,r22
 233 0076 00C0      		rjmp .L8
 345:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 234               		.loc 1 345 57 discriminator 3 view .LVU48
 235 0078 2281      		ldd r18,Z+2
 236 007a 2111      		cpse r18,__zero_reg__
 237 007c 00C0      		rjmp .L8
 347:./tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 238               		.loc 1 347 17 view .LVU49
 239 007e 2381      		ldd r18,Z+3
 240 0080 3481      		ldd r19,Z+4
 241 0082 2417      		cp r18,r20
 242 0084 3507      		cpc r19,r21
 243 0086 00F0      		brlo .L10
 347:./tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 244               		.loc 1 347 17 discriminator 1 view .LVU50
 245 0088 241B      		sub r18,r20
 246 008a 350B      		sbc r19,r21
 247               	.L28:
 347:./tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 248               		.loc 1 347 17 discriminator 2 view .LVU51
 249 008c 283C      		cpi r18,-56
 250 008e 3105      		cpc r19,__zero_reg__
 251 0090 00F4      		brsh .L8
 348:./tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 252               		.loc 1 348 13 is_stmt 1 view .LVU52
 348:./tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 253               		.loc 1 348 35 is_stmt 0 view .LVU53
 254 0092 2091 0000 		lds r18,tapping_key+5
 255 0096 2F70      		andi r18,lo8(15)
 256 0098 2061      		ori r18,lo8(16)
 257 009a 2093 0000 		sts tapping_key+5,r18
 349:./tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 258               		.loc 1 349 13 is_stmt 1 view .LVU54
 349:./tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 259               		.loc 1 349 41 is_stmt 0 view .LVU55
 260 009e 26E0      		ldi r18,lo8(6)
 261 00a0 289F      		mul r18,r24
 262 00a2 F001      		movw r30,r0
 263 00a4 299F      		mul r18,r25
 264 00a6 F00D      		add r31,r0
 265 00a8 1124      		clr __zero_reg__
 266 00aa E050      		subi r30,lo8(-(waiting_buffer+5))
 267 00ac F040      		sbci r31,hi8(-(waiting_buffer+5))
 268 00ae 8081      		ld r24,Z
 269               	.LVL12:
 349:./tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 270               		.loc 1 349 41 view .LVU56
 271 00b0 8F70      		andi r24,lo8(15)
 272 00b2 8061      		ori r24,lo8(16)
 273 00b4 8083      		st Z,r24
 350:./tmk_core/common/action_tapping.c **** 
 274               		.loc 1 350 13 is_stmt 1 view .LVU57
 275 00b6 80E0      		ldi r24,lo8(tapping_key)
 276 00b8 90E0      		ldi r25,hi8(tapping_key)
 277 00ba 0E94 0000 		call process_record
 278               	.LVL13:
 352:./tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 279               		.loc 1 352 57 view .LVU58
 352:./tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 280               		.loc 1 352 71 view .LVU59
 352:./tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 281               		.loc 1 352 85 view .LVU60
 353:./tmk_core/common/action_tapping.c ****             return;
 282               		.loc 1 353 13 view .LVU61
 283               	/* epilogue start */
 284               	.LBE11:
 357:./tmk_core/common/action_tapping.c **** 
 285               		.loc 1 357 1 is_stmt 0 view .LVU62
 286 00be DF91      		pop r29
 287 00c0 CF91      		pop r28
 288 00c2 1F91      		pop r17
 289               	.LBB12:
 353:./tmk_core/common/action_tapping.c ****             return;
 290               		.loc 1 353 13 view .LVU63
 291 00c4 0C94 0000 		jmp debug_waiting_buffer
 292               	.LVL14:
 293               	.LBE12:
 294               		.cfi_endproc
 295               	.LFE10:
 297               		.section	.text.process_tapping,"ax",@progbits
 299               	process_tapping:
 300               	.LVL15:
 301               	.LFB5:
  80:./tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
 302               		.loc 1 80 1 is_stmt 1 view -0
 303               		.cfi_startproc
  80:./tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
 304               		.loc 1 80 1 is_stmt 0 view .LVU65
 305 0000 9F92      		push r9
 306               	.LCFI6:
 307               		.cfi_def_cfa_offset 3
 308               		.cfi_offset 9, -2
 309 0002 AF92      		push r10
 310               	.LCFI7:
 311               		.cfi_def_cfa_offset 4
 312               		.cfi_offset 10, -3
 313 0004 BF92      		push r11
 314               	.LCFI8:
 315               		.cfi_def_cfa_offset 5
 316               		.cfi_offset 11, -4
 317 0006 CF92      		push r12
 318               	.LCFI9:
 319               		.cfi_def_cfa_offset 6
 320               		.cfi_offset 12, -5
 321 0008 DF92      		push r13
 322               	.LCFI10:
 323               		.cfi_def_cfa_offset 7
 324               		.cfi_offset 13, -6
 325 000a EF92      		push r14
 326               	.LCFI11:
 327               		.cfi_def_cfa_offset 8
 328               		.cfi_offset 14, -7
 329 000c FF92      		push r15
 330               	.LCFI12:
 331               		.cfi_def_cfa_offset 9
 332               		.cfi_offset 15, -8
 333 000e 0F93      		push r16
 334               	.LCFI13:
 335               		.cfi_def_cfa_offset 10
 336               		.cfi_offset 16, -9
 337 0010 1F93      		push r17
 338               	.LCFI14:
 339               		.cfi_def_cfa_offset 11
 340               		.cfi_offset 17, -10
 341 0012 CF93      		push r28
 342               	.LCFI15:
 343               		.cfi_def_cfa_offset 12
 344               		.cfi_offset 28, -11
 345 0014 DF93      		push r29
 346               	.LCFI16:
 347               		.cfi_def_cfa_offset 13
 348               		.cfi_offset 29, -12
 349 0016 CDB7      		in r28,__SP_L__
 350 0018 DEB7      		in r29,__SP_H__
 351               	.LCFI17:
 352               		.cfi_def_cfa_register 28
 353 001a 2B97      		sbiw r28,11
 354               	.LCFI18:
 355               		.cfi_def_cfa_offset 24
 356 001c 0FB6      		in __tmp_reg__,__SREG__
 357 001e F894      		cli
 358 0020 DEBF      		out __SP_H__,r29
 359 0022 0FBE      		out __SREG__,__tmp_reg__
 360 0024 CDBF      		out __SP_L__,r28
 361               	/* prologue: function */
 362               	/* frame size = 11 */
 363               	/* stack size = 22 */
 364               	.L__stack_usage = 22
 365 0026 8C01      		movw r16,r24
  81:./tmk_core/common/action_tapping.c **** 
 366               		.loc 1 81 5 is_stmt 1 view .LVU66
  81:./tmk_core/common/action_tapping.c **** 
 367               		.loc 1 81 16 is_stmt 0 view .LVU67
 368 0028 85E0      		ldi r24,lo8(5)
 369               	.LVL16:
  81:./tmk_core/common/action_tapping.c **** 
 370               		.loc 1 81 16 view .LVU68
 371 002a F801      		movw r30,r16
 372 002c DE01      		movw r26,r28
 373 002e 1796      		adiw r26,7
 374               		0:
 375 0030 0190      		ld r0,Z+
 376 0032 0D92      		st X+,r0
 377 0034 8A95      		dec r24
 378 0036 01F4      		brne 0b
 379 0038 D801      		movw r26,r16
 380 003a 4C91      		ld r20,X
 381               	.LVL17:
  81:./tmk_core/common/action_tapping.c **** 
 382               		.loc 1 81 16 view .LVU69
 383 003c 1196      		adiw r26,1
 384 003e 5C91      		ld r21,X
 385 0040 1197      		sbiw r26,1
 386               	.LVL18:
  81:./tmk_core/common/action_tapping.c **** 
 387               		.loc 1 81 16 view .LVU70
 388 0042 1296      		adiw r26,2
 389 0044 EC90      		ld r14,X
 390 0046 1297      		sbiw r26,2
 391               	.LVL19:
  84:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 392               		.loc 1 84 5 is_stmt 1 view .LVU71
  84:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 393               		.loc 1 84 9 is_stmt 0 view .LVU72
 394 0048 8091 0000 		lds r24,tapping_key+3
 395 004c 9091 0000 		lds r25,tapping_key+3+1
 396               	.LBB28:
 397               	.LBI28:
 398               		.loc 2 49 20 is_stmt 1 view .LVU73
 399               	.LBB29:
 400               		.loc 2 49 51 view .LVU74
 401               		.loc 2 49 74 is_stmt 0 view .LVU75
 402 0050 0097      		sbiw r24,0
 403 0052 01F4      		brne .+2
 404 0054 00C0      		rjmp .L30
 405               	.LBE29:
 406               	.LBE28:
  84:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 407               		.loc 1 84 9 view .LVU76
 408 0056 2091 0000 		lds r18,tapping_key
 409 005a 3091 0000 		lds r19,tapping_key+1
 410               	.LBB31:
 411               	.LBB30:
 412               		.loc 2 49 74 view .LVU77
 413 005e 632F      		mov r22,r19
 414 0060 6223      		and r22,r18
 415 0062 6F3F      		cpi r22,lo8(-1)
 416 0064 01F4      		brne .+2
 417 0066 00C0      		rjmp .L30
 418               	.LBE30:
 419               	.LBE31:
  81:./tmk_core/common/action_tapping.c **** 
 420               		.loc 1 81 16 discriminator 1 view .LVU78
 421 0068 1396      		adiw r26,3
 422 006a CD90      		ld r12,X+
 423 006c DC90      		ld r13,X
  84:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 424               		.loc 1 84 9 discriminator 1 view .LVU79
 425 006e 9090 0000 		lds r9,tapping_key+2
 426 0072 9920      		tst r9
 427 0074 01F4      		brne .+2
 428 0076 00C0      		rjmp .L31
  85:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 429               		.loc 1 85 9 is_stmt 1 view .LVU80
  85:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 430               		.loc 1 85 13 is_stmt 0 view .LVU81
 431 0078 C816      		cp r12,r24
 432 007a D906      		cpc r13,r25
 433 007c 00F4      		brsh .+2
 434 007e 00C0      		rjmp .L32
  85:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 435               		.loc 1 85 13 discriminator 1 view .LVU82
 436 0080 F601      		movw r30,r12
 437 0082 E81B      		sub r30,r24
 438 0084 F90B      		sbc r31,r25
 439 0086 CF01      		movw r24,r30
 440               	.L120:
  85:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 441               		.loc 1 85 13 discriminator 2 view .LVU83
 442 0088 FF24      		clr r15
 443 008a F394      		inc r15
 444 008c 883C      		cpi r24,-56
 445 008e 9105      		cpc r25,__zero_reg__
 446 0090 00F0      		brlo .L34
 447 0092 F12C      		mov r15,__zero_reg__
 448               	.L34:
 449 0094 80E0      		ldi r24,lo8(tapping_key)
 450 0096 A82E      		mov r10,r24
 451 0098 80E0      		ldi r24,hi8(tapping_key)
 452 009a B82E      		mov r11,r24
 453 009c 8091 0000 		lds r24,tapping_key+5
 454 00a0 982F      		mov r25,r24
 455 00a2 907F      		andi r25,lo8(-16)
  85:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 456               		.loc 1 85 12 discriminator 4 view .LVU84
 457 00a4 FF20      		tst r15
 458 00a6 01F4      		brne .+2
 459 00a8 00C0      		rjmp .L36
  86:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 460               		.loc 1 86 13 is_stmt 1 view .LVU85
  86:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 461               		.loc 1 86 16 is_stmt 0 view .LVU86
 462 00aa 9111      		cpse r25,__zero_reg__
 463 00ac 00C0      		rjmp .L37
  87:./tmk_core/common/action_tapping.c ****                     // first tap!
 464               		.loc 1 87 17 is_stmt 1 discriminator 1 view .LVU87
 465 00ae FE2C      		mov r15,r14
  87:./tmk_core/common/action_tapping.c ****                     // first tap!
 466               		.loc 1 87 21 is_stmt 0 discriminator 1 view .LVU88
 467 00b0 3513      		cpse r19,r21
 468 00b2 00C0      		rjmp .L38
  87:./tmk_core/common/action_tapping.c ****                     // first tap!
 469               		.loc 1 87 21 discriminator 2 view .LVU89
 470 00b4 2413      		cpse r18,r20
 471 00b6 00C0      		rjmp .L38
  87:./tmk_core/common/action_tapping.c ****                     // first tap!
 472               		.loc 1 87 47 discriminator 3 view .LVU90
 473 00b8 E110      		cpse r14,__zero_reg__
 474 00ba 00C0      		rjmp .L38
  89:./tmk_core/common/action_tapping.c ****                     tapping_key.tap.count = 1;
 475               		.loc 1 89 57 is_stmt 1 view .LVU91
  90:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 476               		.loc 1 90 21 view .LVU92
  90:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 477               		.loc 1 90 43 is_stmt 0 view .LVU93
 478 00bc 8F70      		andi r24,lo8(15)
 479 00be 8061      		ori r24,lo8(16)
 480 00c0 8093 0000 		sts tapping_key+5,r24
 481               	.LVL20:
  91:./tmk_core/common/action_tapping.c ****                     process_record(&tapping_key);
 482               		.loc 1 91 21 is_stmt 1 view .LVU94
 483 00c4 0E94 0000 		call debug_tapping_key
 484               	.LVL21:
  92:./tmk_core/common/action_tapping.c **** 
 485               		.loc 1 92 21 view .LVU95
 486 00c8 C501      		movw r24,r10
 487 00ca 0E94 0000 		call process_record
 488               	.LVL22:
  95:./tmk_core/common/action_tapping.c ****                     // enqueue
 489               		.loc 1 95 21 view .LVU96
  95:./tmk_core/common/action_tapping.c ****                     // enqueue
 490               		.loc 1 95 31 is_stmt 0 view .LVU97
 491 00ce 8091 0000 		lds r24,tapping_key+5
 492 00d2 D801      		movw r26,r16
 493 00d4 1596      		adiw r26,5
 494 00d6 8C93      		st X,r24
  97:./tmk_core/common/action_tapping.c ****                 }
 495               		.loc 1 97 21 is_stmt 1 view .LVU98
 496               	.LVL23:
 497               	.L29:
 287:./tmk_core/common/action_tapping.c **** 
 498               		.loc 1 287 1 is_stmt 0 view .LVU99
 499 00d8 8F2D      		mov r24,r15
 500               	/* epilogue start */
 287:./tmk_core/common/action_tapping.c **** 
 501               		.loc 1 287 1 view .LVU100
 502 00da 2B96      		adiw r28,11
 503 00dc 0FB6      		in __tmp_reg__,__SREG__
 504 00de F894      		cli
 505 00e0 DEBF      		out __SP_H__,r29
 506 00e2 0FBE      		out __SREG__,__tmp_reg__
 507 00e4 CDBF      		out __SP_L__,r28
 508 00e6 DF91      		pop r29
 509 00e8 CF91      		pop r28
 510 00ea 1F91      		pop r17
 511 00ec 0F91      		pop r16
 512               	.LVL24:
 287:./tmk_core/common/action_tapping.c **** 
 513               		.loc 1 287 1 view .LVU101
 514 00ee FF90      		pop r15
 515 00f0 EF90      		pop r14
 516               	.LVL25:
 287:./tmk_core/common/action_tapping.c **** 
 517               		.loc 1 287 1 view .LVU102
 518 00f2 DF90      		pop r13
 519 00f4 CF90      		pop r12
 520 00f6 BF90      		pop r11
 521 00f8 AF90      		pop r10
 522 00fa 9F90      		pop r9
 523 00fc 0895      		ret
 524               	.LVL26:
 525               	.L32:
  85:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 526               		.loc 1 85 13 discriminator 2 view .LVU103
 527 00fe 8095      		com r24
 528 0100 9095      		com r25
 529 0102 8C0D      		add r24,r12
 530 0104 9D1D      		adc r25,r13
 531 0106 00C0      		rjmp .L120
 532               	.L38:
 117:./tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 533               		.loc 1 117 22 is_stmt 1 view .LVU104
 534               	.LVL27:
 535               	.LBB32:
 536               	.LBI32:
  50:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
  51:./tmk_core/common/keyboard.h **** static inline bool IS_RELEASED(keyevent_t event) { return (!IS_NOEVENT(event) && !event.pressed); }
 537               		.loc 2 51 20 view .LVU105
 538               	.LBB33:
 539               		.loc 2 51 52 view .LVU106
 540               	.LBB34:
 541               	.LBI34:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 542               		.loc 2 49 20 view .LVU107
 543               	.LBB35:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 544               		.loc 2 49 51 view .LVU108
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 545               		.loc 2 49 74 is_stmt 0 view .LVU109
 546 0108 CD28      		or r12,r13
 547 010a 01F0      		breq .L69
 548 010c 842F      		mov r24,r20
 549 010e 8523      		and r24,r21
 550 0110 8F3F      		cpi r24,lo8(-1)
 551 0112 01F0      		breq .+2
 552 0114 00C0      		rjmp .L41
 553               	.L69:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 554               		.loc 2 49 74 view .LVU110
 555               	.LBE35:
 556               	.LBE34:
 557               		.loc 2 51 79 view .LVU111
 558 0116 80E0      		ldi r24,0
 559               	.L40:
 560               	.LVL28:
 561               		.loc 2 51 79 view .LVU112
 562               	.LBE33:
 563               	.LBE32:
 117:./tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 564               		.loc 1 117 25 view .LVU113
 565 0118 B82F      		mov r27,r24
 566 011a B170      		andi r27,lo8(1)
 567 011c DB2E      		mov r13,r27
 568               	.LBB37:
 569               	.LBB38:
 319:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 570               		.loc 1 319 18 view .LVU114
 571 011e E091 0000 		lds r30,waiting_buffer_tail
 572               	.LVL29:
 319:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 573               		.loc 1 319 45 view .LVU115
 574 0122 2091 0000 		lds r18,waiting_buffer_head
 320:./tmk_core/common/action_tapping.c ****             return true;
 575               		.loc 1 320 13 view .LVU116
 576 0126 36E0      		ldi r19,lo8(6)
 577               	.LBE38:
 578               	.LBE37:
 117:./tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 579               		.loc 1 117 25 view .LVU117
 580 0128 80FD      		sbrc r24,0
 581 012a 00C0      		rjmp .L43
 582               	.LVL30:
 583               	.L42:
 139:./tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 584               		.loc 1 139 21 is_stmt 1 view .LVU118
 139:./tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 585               		.loc 1 139 24 is_stmt 0 view .LVU119
 586 012c EE20      		tst r14
 587 012e 01F0      		breq .L29
 140:./tmk_core/common/action_tapping.c ****                     }
 588               		.loc 1 140 25 is_stmt 1 view .LVU120
 140:./tmk_core/common/action_tapping.c ****                     }
 589               		.loc 1 140 53 is_stmt 0 view .LVU121
 590 0130 8091 0000 		lds r24,tapping_key+5
 591 0134 8160      		ori r24,lo8(1<<0)
 592 0136 8093 0000 		sts tapping_key+5,r24
 143:./tmk_core/common/action_tapping.c ****                 }
 593               		.loc 1 143 28 view .LVU122
 594 013a F12C      		mov r15,__zero_reg__
 595 013c 00C0      		rjmp .L29
 596               	.LVL31:
 597               	.L45:
 598               	.LBB40:
 599               	.LBB39:
 320:./tmk_core/common/action_tapping.c ****             return true;
 600               		.loc 1 320 9 is_stmt 1 view .LVU123
 320:./tmk_core/common/action_tapping.c ****             return true;
 601               		.loc 1 320 13 is_stmt 0 view .LVU124
 602 013e 8E2F      		mov r24,r30
 603 0140 90E0      		ldi r25,0
 604 0142 3E9F      		mul r19,r30
 605 0144 F001      		movw r30,r0
 606 0146 1124      		clr __zero_reg__
 607               	.LVL32:
 320:./tmk_core/common/action_tapping.c ****             return true;
 608               		.loc 1 320 13 view .LVU125
 609 0148 E050      		subi r30,lo8(-(waiting_buffer))
 610 014a F040      		sbci r31,hi8(-(waiting_buffer))
 320:./tmk_core/common/action_tapping.c ****             return true;
 611               		.loc 1 320 12 view .LVU126
 612 014c 6181      		ldd r22,Z+1
 613 014e 6513      		cpse r22,r21
 614 0150 00C0      		rjmp .L44
 320:./tmk_core/common/action_tapping.c ****             return true;
 615               		.loc 1 320 13 view .LVU127
 616 0152 6081      		ld r22,Z
 617 0154 6413      		cpse r22,r20
 618 0156 00C0      		rjmp .L44
 320:./tmk_core/common/action_tapping.c ****             return true;
 619               		.loc 1 320 59 view .LVU128
 620 0158 6281      		ldd r22,Z+2
 621 015a 6E11      		cpse r22,r14
 622 015c 00C0      		rjmp .L42
 623               	.L44:
 319:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 624               		.loc 1 319 69 is_stmt 1 view .LVU129
 319:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 625               		.loc 1 319 76 is_stmt 0 view .LVU130
 626 015e FC01      		movw r30,r24
 627 0160 3196      		adiw r30,1
 319:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 628               		.loc 1 319 71 view .LVU131
 629 0162 E770      		andi r30,lo8(7)
 630               	.LVL33:
 631               	.L43:
 319:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 632               		.loc 1 319 43 is_stmt 1 view .LVU132
 319:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 633               		.loc 1 319 5 is_stmt 0 view .LVU133
 634 0164 E213      		cpse r30,r18
 635 0166 00C0      		rjmp .L45
 636               	.LVL34:
 319:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 637               		.loc 1 319 5 view .LVU134
 638               	.LBE39:
 639               	.LBE40:
 640               	.LBB41:
 119:./tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 641               		.loc 1 119 21 is_stmt 1 view .LVU135
 119:./tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 642               		.loc 1 119 39 is_stmt 0 view .LVU136
 643 0168 4F83      		std Y+7,r20
 644 016a 5887      		std Y+8,r21
 645 016c 8F81      		ldd r24,Y+7
 646 016e 9885      		ldd r25,Y+8
 647 0170 0E94 0000 		call layer_switch_get_action
 648               	.LVL35:
 120:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 649               		.loc 1 120 21 is_stmt 1 view .LVU137
 120:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 650               		.loc 1 120 40 is_stmt 0 view .LVU138
 651 0174 292F      		mov r18,r25
 652 0176 2295      		swap r18
 653 0178 2F70      		andi r18,lo8(15)
 120:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 654               		.loc 1 120 21 view .LVU139
 655 017a 9032      		cpi r25,lo8(32)
 656 017c 00F0      		brlo .L67
 120:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 657               		.loc 1 120 21 view .LVU140
 658 017e 225F      		subi r18,lo8(-(14))
 659 0180 2F70      		andi r18,lo8(15)
 660 0182 2230      		cpi r18,lo8(2)
 661 0184 00F4      		brsh .L49
 128:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 662               		.loc 1 128 29 is_stmt 1 view .LVU141
 128:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 663               		.loc 1 128 33 is_stmt 0 view .LVU142
 664 0186 9F70      		andi r25,lo8(15)
 665               	.LVL36:
 128:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 666               		.loc 1 128 32 view .LVU143
 667 0188 01F0      		breq .L50
 128:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 668               		.loc 1 128 68 discriminator 1 view .LVU144
 669 018a F801      		movw r30,r16
 670 018c 9581      		ldd r25,Z+5
 671 018e 907F      		andi r25,lo8(-16)
 128:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 672               		.loc 1 128 49 discriminator 1 view .LVU145
 673 0190 01F4      		brne .L50
 674               	.LVL37:
 675               	.L73:
 123:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 676               		.loc 1 123 77 view .LVU146
 677 0192 D12C      		mov r13,__zero_reg__
 678 0194 00C0      		rjmp .L48
 679               	.LVL38:
 680               	.L67:
 123:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 681               		.loc 1 123 29 is_stmt 1 view .LVU147
 123:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 682               		.loc 1 123 33 is_stmt 0 view .LVU148
 683 0196 9F70      		andi r25,lo8(15)
 684               	.LVL39:
 123:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 685               		.loc 1 123 32 view .LVU149
 686 0198 01F0      		breq .L50
 123:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 687               		.loc 1 123 49 discriminator 1 view .LVU150
 688 019a 8823      		tst r24
 689 019c 01F0      		breq .L73
 690               	.L50:
 129:./tmk_core/common/action_tapping.c ****                             break;
 691               		.loc 1 129 29 is_stmt 1 view .LVU151
 129:./tmk_core/common/action_tapping.c ****                             break;
 692               		.loc 1 129 33 is_stmt 0 view .LVU152
 693 019e 805E      		subi r24,lo8(-(32))
 694               	.LVL40:
 129:./tmk_core/common/action_tapping.c ****                             break;
 695               		.loc 1 129 32 view .LVU153
 696 01a0 8830      		cpi r24,lo8(8)
 697 01a2 00F0      		brlo .L73
 698               	.LVL41:
 699               	.L49:
 133:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 700               		.loc 1 133 86 is_stmt 1 view .LVU154
 134:./tmk_core/common/action_tapping.c ****                     return true;
 701               		.loc 1 134 21 view .LVU155
 702 01a4 C801      		movw r24,r16
 703               	.LVL42:
 134:./tmk_core/common/action_tapping.c ****                     return true;
 704               		.loc 1 134 21 is_stmt 0 view .LVU156
 705 01a6 0E94 0000 		call process_record
 706               	.LVL43:
 135:./tmk_core/common/action_tapping.c ****                 }
 707               		.loc 1 135 21 is_stmt 1 view .LVU157
 708               	.L48:
 135:./tmk_core/common/action_tapping.c ****                 }
 709               		.loc 1 135 21 is_stmt 0 view .LVU158
 710 01aa FD2C      		mov r15,r13
 711 01ac 00C0      		rjmp .L29
 712               	.LVL44:
 713               	.L37:
 135:./tmk_core/common/action_tapping.c ****                 }
 714               		.loc 1 135 21 view .LVU159
 715               	.LBE41:
 148:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 716               		.loc 1 148 17 is_stmt 1 discriminator 1 view .LVU160
 148:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 717               		.loc 1 148 21 is_stmt 0 discriminator 1 view .LVU161
 718 01ae 3513      		cpse r19,r21
 719 01b0 00C0      		rjmp .L51
 148:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 720               		.loc 1 148 21 discriminator 2 view .LVU162
 721 01b2 2413      		cpse r18,r20
 722 01b4 00C0      		rjmp .L51
 150:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 723               		.loc 1 150 31 discriminator 3 view .LVU163
 724 01b6 D801      		movw r26,r16
 148:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 725               		.loc 1 148 47 discriminator 3 view .LVU164
 726 01b8 EE20      		tst r14
 727 01ba 01F4      		brne .+2
 728 01bc 00C0      		rjmp .L127
 729               	.L51:
 156:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 730               		.loc 1 156 22 is_stmt 1 view .LVU165
 156:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 731               		.loc 1 156 26 is_stmt 0 view .LVU166
 732 01be 4F83      		std Y+7,r20
 733 01c0 5887      		std Y+8,r21
 734 01c2 8F81      		ldd r24,Y+7
 735 01c4 9885      		ldd r25,Y+8
 736 01c6 0E94 0000 		call is_tap_key
 737               	.LVL45:
 156:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 738               		.loc 1 156 25 view .LVU167
 739 01ca 8823      		tst r24
 740 01cc 01F4      		brne .+2
 741 01ce 00C0      		rjmp .L63
 156:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 742               		.loc 1 156 48 discriminator 1 view .LVU168
 743 01d0 EE20      		tst r14
 744 01d2 01F4      		brne .+2
 745 01d4 00C0      		rjmp .L63
 157:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 746               		.loc 1 157 21 is_stmt 1 view .LVU169
 157:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 747               		.loc 1 157 40 is_stmt 0 view .LVU170
 748 01d6 8091 0000 		lds r24,tapping_key+5
 157:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 749               		.loc 1 157 24 view .LVU171
 750 01da 8032      		cpi r24,lo8(32)
 751 01dc 00F0      		brlo .L54
 752               	.LBB42:
 158:./tmk_core/common/action_tapping.c ****                         // unregister key
 753               		.loc 1 158 87 is_stmt 1 view .LVU172
 160:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 754               		.loc 1 160 25 view .LVU173
 160:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 755               		.loc 1 160 54 is_stmt 0 view .LVU174
 756 01de 2091 0000 		lds r18,tapping_key
 757 01e2 3091 0000 		lds r19,tapping_key+1
 758 01e6 3A83      		std Y+2,r19
 759 01e8 2983      		std Y+1,r18
 760 01ea 1B82      		std Y+3,__zero_reg__
 761 01ec DD82      		std Y+5,r13
 762 01ee CC82      		std Y+4,r12
 763 01f0 8E83      		std Y+6,r24
 160:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 764               		.loc 1 160 25 view .LVU175
 765 01f2 CE01      		movw r24,r28
 766 01f4 0196      		adiw r24,1
 767 01f6 0E94 0000 		call process_record
 768               	.LVL46:
 769               	.L54:
 160:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 770               		.loc 1 160 25 view .LVU176
 771               	.LBE42:
 167:./tmk_core/common/action_tapping.c ****                     }
 772               		.loc 1 167 69 is_stmt 1 view .LVU177
 169:./tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 773               		.loc 1 169 21 view .LVU178
 169:./tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 774               		.loc 1 169 33 is_stmt 0 view .LVU179
 775 01fa 86E0      		ldi r24,lo8(6)
 776 01fc F801      		movw r30,r16
 777 01fe A0E0      		ldi r26,lo8(tapping_key)
 778 0200 B0E0      		ldi r27,hi8(tapping_key)
 779               		0:
 780 0202 0190      		ld r0,Z+
 781 0204 0D92      		st X+,r0
 782 0206 8A95      		dec r24
 783 0208 01F4      		brne 0b
 170:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 784               		.loc 1 170 21 is_stmt 1 view .LVU180
 785 020a 0E94 0000 		call waiting_buffer_scan_tap
 786               	.LVL47:
 171:./tmk_core/common/action_tapping.c ****                     return true;
 787               		.loc 1 171 21 view .LVU181
 788 020e 0E94 0000 		call debug_tapping_key
 789               	.LVL48:
 172:./tmk_core/common/action_tapping.c ****                 }
 790               		.loc 1 172 21 view .LVU182
 791               	.L124:
 179:./tmk_core/common/action_tapping.c ****                 }
 792               		.loc 1 179 21 view .LVU183
 179:./tmk_core/common/action_tapping.c ****                 }
 793               		.loc 1 179 28 is_stmt 0 view .LVU184
 794 0212 FF24      		clr r15
 795 0214 F394      		inc r15
 796 0216 00C0      		rjmp .L29
 797               	.LVL49:
 798               	.L36:
 185:./tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 799               		.loc 1 185 13 is_stmt 1 view .LVU185
 185:./tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 800               		.loc 1 185 16 is_stmt 0 view .LVU186
 801 0218 9111      		cpse r25,__zero_reg__
 802 021a 00C0      		rjmp .L55
 803               	.LBB43:
 186:./tmk_core/common/action_tapping.c ****                 debug_event(event); debug("\n");
 804               		.loc 1 186 61 is_stmt 1 view .LVU187
 187:./tmk_core/common/action_tapping.c ****                 process_record(&tapping_key);
 805               		.loc 1 187 17 view .LVU188
 187:./tmk_core/common/action_tapping.c ****                 process_record(&tapping_key);
 806               		.loc 1 187 17 is_stmt 0 view .LVU189
 807 021c 7C2D      		mov r23,r12
 808 021e DB86      		std Y+11,r13
 809 0220 CA86      		std Y+10,r12
 810 0222 6E2D      		mov r22,r14
 811 0224 8B85      		ldd r24,Y+11
 812 0226 0E94 0000 		call debug_event
 813               	.LVL50:
 187:./tmk_core/common/action_tapping.c ****                 process_record(&tapping_key);
 814               		.loc 1 187 48 is_stmt 1 view .LVU190
 188:./tmk_core/common/action_tapping.c ****                 tapping_key = (keyrecord_t){};
 815               		.loc 1 188 17 view .LVU191
 816 022a 80E0      		ldi r24,lo8(tapping_key)
 817 022c 90E0      		ldi r25,hi8(tapping_key)
 818 022e 0E94 0000 		call process_record
 819               	.LVL51:
 189:./tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 820               		.loc 1 189 17 view .LVU192
 189:./tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 821               		.loc 1 189 29 is_stmt 0 view .LVU193
 822 0232 86E0      		ldi r24,lo8(6)
 823 0234 F501      		movw r30,r10
 824               		0:
 825 0236 1192      		st Z+,__zero_reg__
 826 0238 8A95      		dec r24
 827 023a 01F4      		brne 0b
 828               	.L123:
 190:./tmk_core/common/action_tapping.c ****                 return false;
 829               		.loc 1 190 17 is_stmt 1 view .LVU194
 830 023c 0E94 0000 		call debug_tapping_key
 831               	.LVL52:
 191:./tmk_core/common/action_tapping.c ****             }  else {
 832               		.loc 1 191 17 view .LVU195
 833 0240 00C0      		rjmp .L29
 834               	.LVL53:
 835               	.L55:
 191:./tmk_core/common/action_tapping.c ****             }  else {
 836               		.loc 1 191 17 is_stmt 0 view .LVU196
 837               	.LBE43:
 193:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 838               		.loc 1 193 17 is_stmt 1 discriminator 1 view .LVU197
 193:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 839               		.loc 1 193 21 is_stmt 0 discriminator 1 view .LVU198
 840 0242 3513      		cpse r19,r21
 841 0244 00C0      		rjmp .L51
 193:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 842               		.loc 1 193 21 discriminator 2 view .LVU199
 843 0246 2413      		cpse r18,r20
 844 0248 00C0      		rjmp .L51
 193:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 845               		.loc 1 193 47 discriminator 3 view .LVU200
 846 024a E110      		cpse r14,__zero_reg__
 847 024c 00C0      		rjmp .L51
 848               	.LBB44:
 194:./tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 849               		.loc 1 194 73 is_stmt 1 view .LVU201
 195:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 850               		.loc 1 195 21 view .LVU202
 195:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 851               		.loc 1 195 31 is_stmt 0 view .LVU203
 852 024e D801      		movw r26,r16
 853 0250 1596      		adiw r26,5
 854 0252 8C93      		st X,r24
 196:./tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 855               		.loc 1 196 21 is_stmt 1 view .LVU204
 856 0254 C801      		movw r24,r16
 857 0256 0E94 0000 		call process_record
 858               	.LVL54:
 197:./tmk_core/common/action_tapping.c ****                     return true;
 859               		.loc 1 197 21 view .LVU205
 197:./tmk_core/common/action_tapping.c ****                     return true;
 860               		.loc 1 197 33 is_stmt 0 view .LVU206
 861 025a 86E0      		ldi r24,lo8(6)
 862 025c F501      		movw r30,r10
 863               		0:
 864 025e 1192      		st Z+,__zero_reg__
 865 0260 8A95      		dec r24
 866 0262 01F4      		brne 0b
 198:./tmk_core/common/action_tapping.c ****                 }
 867               		.loc 1 198 21 is_stmt 1 view .LVU207
 198:./tmk_core/common/action_tapping.c ****                 }
 868               		.loc 1 198 28 is_stmt 0 view .LVU208
 869 0264 F92C      		mov r15,r9
 870 0266 00C0      		rjmp .L29
 871               	.LVL55:
 872               	.L31:
 198:./tmk_core/common/action_tapping.c ****                 }
 873               		.loc 1 198 28 view .LVU209
 874               	.LBE44:
 227:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 875               		.loc 1 227 12 is_stmt 1 discriminator 1 view .LVU210
 228:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 876               		.loc 1 228 9 discriminator 1 view .LVU211
 228:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 877               		.loc 1 228 13 is_stmt 0 discriminator 1 view .LVU212
 878 0268 C816      		cp r12,r24
 879 026a D906      		cpc r13,r25
 880 026c 00F0      		brlo .L58
 881 026e B601      		movw r22,r12
 882 0270 681B      		sub r22,r24
 883 0272 790B      		sbc r23,r25
 884 0274 CB01      		movw r24,r22
 885               	.L129:
 228:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 886               		.loc 1 228 13 discriminator 2 view .LVU213
 887 0276 F12C      		mov r15,__zero_reg__
 888 0278 883C      		cpi r24,-56
 889 027a 9105      		cpc r25,__zero_reg__
 890 027c 00F0      		brlo .+2
 891 027e 00C0      		rjmp .L62
 229:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 892               		.loc 1 229 13 is_stmt 1 view .LVU214
 229:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 893               		.loc 1 229 22 is_stmt 0 view .LVU215
 894 0280 FE2C      		mov r15,r14
 229:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 895               		.loc 1 229 16 view .LVU216
 896 0282 EE20      		tst r14
 897 0284 01F4      		brne .+2
 898 0286 00C0      		rjmp .L63
 230:./tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 899               		.loc 1 230 17 is_stmt 1 discriminator 1 view .LVU217
 230:./tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 900               		.loc 1 230 21 is_stmt 0 discriminator 1 view .LVU218
 901 0288 3513      		cpse r19,r21
 902 028a 00C0      		rjmp .L64
 230:./tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 903               		.loc 1 230 21 discriminator 2 view .LVU219
 904 028c 2413      		cpse r18,r20
 905 028e 00C0      		rjmp .L64
 231:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 906               		.loc 1 231 21 is_stmt 1 view .LVU220
 231:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 907               		.loc 1 231 41 is_stmt 0 view .LVU221
 908 0290 8091 0000 		lds r24,tapping_key+5
 231:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 909               		.loc 1 231 24 view .LVU222
 910 0294 80FD      		sbrc r24,0
 911 0296 00C0      		rjmp .L65
 231:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 912               		.loc 1 231 79 discriminator 1 view .LVU223
 913 0298 982F      		mov r25,r24
 914 029a 907F      		andi r25,lo8(-16)
 231:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 915               		.loc 1 231 54 discriminator 1 view .LVU224
 916 029c 01F0      		breq .L65
 233:./tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 917               		.loc 1 233 25 is_stmt 1 view .LVU225
 233:./tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 918               		.loc 1 233 35 is_stmt 0 view .LVU226
 919 029e D801      		movw r26,r16
 920 02a0 1596      		adiw r26,5
 921 02a2 8C93      		st X,r24
 922 02a4 1597      		sbiw r26,5
 234:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 923               		.loc 1 234 25 is_stmt 1 view .LVU227
 234:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 924               		.loc 1 234 28 is_stmt 0 view .LVU228
 925 02a6 903F      		cpi r25,lo8(-16)
 926 02a8 01F0      		breq .L66
 234:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 927               		.loc 1 234 51 is_stmt 1 discriminator 1 view .LVU229
 234:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 928               		.loc 1 234 67 is_stmt 0 discriminator 1 view .LVU230
 929 02aa 982F      		mov r25,r24
 930 02ac 907F      		andi r25,lo8(-16)
 931 02ae 905F      		subi r25,lo8(-(16))
 932 02b0 8F70      		andi r24,lo8(15)
 933 02b2 892B      		or r24,r25
 934               	.L127:
 234:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 935               		.loc 1 234 67 discriminator 1 view .LVU231
 936 02b4 1596      		adiw r26,5
 937 02b6 8C93      		st X,r24
 938               	.L66:
 235:./tmk_core/common/action_tapping.c ****                         process_record(keyp);
 939               		.loc 1 235 53 is_stmt 1 view .LVU232
 235:./tmk_core/common/action_tapping.c ****                         process_record(keyp);
 940               		.loc 1 235 81 view .LVU233
 235:./tmk_core/common/action_tapping.c ****                         process_record(keyp);
 941               		.loc 1 235 95 view .LVU234
 236:./tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 942               		.loc 1 236 25 view .LVU235
 943 02b8 C801      		movw r24,r16
 944 02ba 0E94 0000 		call process_record
 945               	.LVL56:
 237:./tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 946               		.loc 1 237 25 view .LVU236
 237:./tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 947               		.loc 1 237 37 is_stmt 0 view .LVU237
 948 02be 86E0      		ldi r24,lo8(6)
 949 02c0 F801      		movw r30,r16
 950 02c2 A0E0      		ldi r26,lo8(tapping_key)
 951 02c4 B0E0      		ldi r27,hi8(tapping_key)
 952               		0:
 953 02c6 0190      		ld r0,Z+
 954 02c8 0D92      		st X+,r0
 955 02ca 8A95      		dec r24
 956 02cc 01F4      		brne 0b
 238:./tmk_core/common/action_tapping.c ****                         return true;
 957               		.loc 1 238 25 is_stmt 1 view .LVU238
 958 02ce 00C0      		rjmp .L123
 959               	.LVL57:
 960               	.L58:
 228:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 961               		.loc 1 228 13 is_stmt 0 discriminator 2 view .LVU239
 962 02d0 8095      		com r24
 963 02d2 9095      		com r25
 964 02d4 8C0D      		add r24,r12
 965 02d6 9D1D      		adc r25,r13
 966 02d8 00C0      		rjmp .L129
 967               	.L65:
 242:./tmk_core/common/action_tapping.c ****                         return true;
 968               		.loc 1 242 25 is_stmt 1 view .LVU240
 242:./tmk_core/common/action_tapping.c ****                         return true;
 969               		.loc 1 242 37 is_stmt 0 view .LVU241
 970 02da 86E0      		ldi r24,lo8(6)
 971 02dc F801      		movw r30,r16
 972 02de A0E0      		ldi r26,lo8(tapping_key)
 973 02e0 B0E0      		ldi r27,hi8(tapping_key)
 974               		0:
 975 02e2 0190      		ld r0,Z+
 976 02e4 0D92      		st X+,r0
 977 02e6 8A95      		dec r24
 978 02e8 01F4      		brne 0b
 243:./tmk_core/common/action_tapping.c ****                     }
 979               		.loc 1 243 25 is_stmt 1 view .LVU242
 243:./tmk_core/common/action_tapping.c ****                     }
 980               		.loc 1 243 32 is_stmt 0 view .LVU243
 981 02ea 00C0      		rjmp .L29
 982               	.L64:
 245:./tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 983               		.loc 1 245 24 is_stmt 1 view .LVU244
 245:./tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 984               		.loc 1 245 28 is_stmt 0 view .LVU245
 985 02ec 4F83      		std Y+7,r20
 986 02ee 5887      		std Y+8,r21
 987 02f0 8F81      		ldd r24,Y+7
 988 02f2 9885      		ldd r25,Y+8
 989 02f4 0E94 0000 		call is_tap_key
 990               	.LVL58:
 245:./tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 991               		.loc 1 245 27 view .LVU246
 992 02f8 8111      		cpse r24,__zero_reg__
 993 02fa 00C0      		rjmp .L54
 255:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 994               		.loc 1 255 21 is_stmt 1 view .LVU247
 255:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 995               		.loc 1 255 49 is_stmt 0 view .LVU248
 996 02fc 8091 0000 		lds r24,tapping_key+5
 997 0300 8160      		ori r24,lo8(1<<0)
 998 0302 8093 0000 		sts tapping_key+5,r24
 256:./tmk_core/common/action_tapping.c ****                     return true;
 999               		.loc 1 256 21 is_stmt 1 view .LVU249
 1000 0306 C801      		movw r24,r16
 1001 0308 0E94 0000 		call process_record
 1002               	.LVL59:
 257:./tmk_core/common/action_tapping.c ****                 }
 1003               		.loc 1 257 21 view .LVU250
 257:./tmk_core/common/action_tapping.c ****                 }
 1004               		.loc 1 257 28 is_stmt 0 view .LVU251
 1005 030c 00C0      		rjmp .L29
 1006               	.LVL60:
 1007               	.L62:
 1008               	.LBB45:
 267:./tmk_core/common/action_tapping.c ****             debug_event(event); debug("\n");
 1009               		.loc 1 267 70 is_stmt 1 view .LVU252
 268:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1010               		.loc 1 268 13 view .LVU253
 268:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1011               		.loc 1 268 13 is_stmt 0 view .LVU254
 1012 030e 7C2D      		mov r23,r12
 1013 0310 DB86      		std Y+11,r13
 1014 0312 CA86      		std Y+10,r12
 1015 0314 6E2D      		mov r22,r14
 1016 0316 8B85      		ldd r24,Y+11
 1017 0318 0E94 0000 		call debug_event
 1018               	.LVL61:
 268:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1019               		.loc 1 268 44 is_stmt 1 view .LVU255
 269:./tmk_core/common/action_tapping.c ****             debug_tapping_key();
 1020               		.loc 1 269 13 view .LVU256
 269:./tmk_core/common/action_tapping.c ****             debug_tapping_key();
 1021               		.loc 1 269 25 is_stmt 0 view .LVU257
 1022 031c 86E0      		ldi r24,lo8(6)
 1023 031e E0E0      		ldi r30,lo8(tapping_key)
 1024 0320 F0E0      		ldi r31,hi8(tapping_key)
 1025 0322 DF01      		movw r26,r30
 1026               		0:
 1027 0324 1D92      		st X+,__zero_reg__
 1028 0326 8A95      		dec r24
 1029 0328 01F4      		brne 0b
 270:./tmk_core/common/action_tapping.c ****             return false;
 1030               		.loc 1 270 13 is_stmt 1 view .LVU258
 1031 032a 00C0      		rjmp .L123
 1032               	.LVL62:
 1033               	.L30:
 270:./tmk_core/common/action_tapping.c ****             return false;
 1034               		.loc 1 270 13 is_stmt 0 view .LVU259
 1035               	.LBE45:
 276:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1036               		.loc 1 276 9 is_stmt 1 view .LVU260
 276:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1037               		.loc 1 276 12 is_stmt 0 view .LVU261
 1038 032c EE20      		tst r14
 1039 032e 01F0      		breq .L63
 276:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1040               		.loc 1 276 30 discriminator 1 view .LVU262
 1041 0330 4F83      		std Y+7,r20
 1042 0332 5887      		std Y+8,r21
 1043 0334 8F81      		ldd r24,Y+7
 1044 0336 9885      		ldd r25,Y+8
 1045 0338 0E94 0000 		call is_tap_key
 1046               	.LVL63:
 276:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1047               		.loc 1 276 27 discriminator 1 view .LVU263
 1048 033c 8111      		cpse r24,__zero_reg__
 1049 033e 00C0      		rjmp .L54
 1050               	.LVL64:
 1051               	.L63:
 175:./tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last tap(>0).\n");
 1052               		.loc 1 175 21 is_stmt 1 view .LVU264
 176:./tmk_core/common/action_tapping.c ****                     }
 1053               		.loc 1 176 74 view .LVU265
 178:./tmk_core/common/action_tapping.c ****                     return true;
 1054               		.loc 1 178 21 view .LVU266
 1055 0340 C801      		movw r24,r16
 1056 0342 0E94 0000 		call process_record
 1057               	.LVL65:
 1058 0346 00C0      		rjmp .L124
 1059               	.LVL66:
 1060               	.L41:
 1061               	.LBB46:
 1062               	.LBB36:
 1063               		.loc 2 51 79 is_stmt 0 view .LVU267
 1064 0348 81E0      		ldi r24,lo8(1)
 1065 034a 8E25      		eor r24,r14
 1066 034c 00C0      		rjmp .L40
 1067               	.LBE36:
 1068               	.LBE46:
 1069               		.cfi_endproc
 1070               	.LFE5:
 1072               		.section	.text.action_tapping_process,"ax",@progbits
 1073               	.global	action_tapping_process
 1075               	action_tapping_process:
 1076               	.LFB4:
  40:./tmk_core/common/action_tapping.c ****     if (process_tapping(&record)) {
 1077               		.loc 1 40 1 is_stmt 1 view -0
 1078               		.cfi_startproc
 1079 0000 1F93      		push r17
 1080               	.LCFI19:
 1081               		.cfi_def_cfa_offset 3
 1082               		.cfi_offset 17, -2
 1083 0002 CF93      		push r28
 1084               	.LCFI20:
 1085               		.cfi_def_cfa_offset 4
 1086               		.cfi_offset 28, -3
 1087 0004 DF93      		push r29
 1088               	.LCFI21:
 1089               		.cfi_def_cfa_offset 5
 1090               		.cfi_offset 29, -4
 1091 0006 CDB7      		in r28,__SP_L__
 1092 0008 DEB7      		in r29,__SP_H__
 1093               	.LCFI22:
 1094               		.cfi_def_cfa_register 28
 1095 000a 2C97      		sbiw r28,12
 1096               	.LCFI23:
 1097               		.cfi_def_cfa_offset 17
 1098 000c 0FB6      		in __tmp_reg__,__SREG__
 1099 000e F894      		cli
 1100 0010 DEBF      		out __SP_H__,r29
 1101 0012 0FBE      		out __SREG__,__tmp_reg__
 1102 0014 CDBF      		out __SP_L__,r28
 1103               	/* prologue: function */
 1104               	/* frame size = 12 */
 1105               	/* stack size = 15 */
 1106               	.L__stack_usage = 15
 1107 0016 4F83      		std Y+7,r20
 1108 0018 5887      		std Y+8,r21
 1109 001a 6987      		std Y+9,r22
 1110 001c 7A87      		std Y+10,r23
 1111 001e 8B87      		std Y+11,r24
 1112 0020 9C87      		std Y+12,r25
  41:./tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1113               		.loc 1 41 5 view .LVU269
  41:./tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1114               		.loc 1 41 9 is_stmt 0 view .LVU270
 1115 0022 CE01      		movw r24,r28
 1116 0024 0796      		adiw r24,7
 1117 0026 0E94 0000 		call process_tapping
 1118               	.LVL67:
  41:./tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1119               		.loc 1 41 8 view .LVU271
 1120 002a 8823      		tst r24
 1121 002c 01F0      		breq .L134
  42:./tmk_core/common/action_tapping.c ****             debug("processed: "); debug_record(record); debug("\n");
 1122               		.loc 1 42 9 is_stmt 1 view .LVU272
 1123               	.LBB56:
 1124               	.LBI56:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1125               		.loc 2 49 20 view .LVU273
 1126               	.LBB57:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1127               		.loc 2 49 51 view .LVU274
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1128               		.loc 2 49 74 is_stmt 0 view .LVU275
 1129 002e 8A85      		ldd r24,Y+10
 1130 0030 9B85      		ldd r25,Y+11
 1131 0032 892B      		or r24,r25
 1132 0034 01F0      		breq .L135
 1133 0036 4F81      		ldd r20,Y+7
 1134 0038 5885      		ldd r21,Y+8
 1135 003a 842F      		mov r24,r20
 1136 003c 8523      		and r24,r21
 1137 003e 8F3F      		cpi r24,lo8(-1)
 1138 0040 01F0      		breq .+2
 1139 0042 00C0      		rjmp .L157
 1140               	.L135:
 1141               	.LBE57:
 1142               	.LBE56:
  60:./tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1143               		.loc 1 60 13 discriminator 1 view .LVU276
 1144 0044 16E0      		ldi r17,lo8(6)
 1145 0046 00C0      		rjmp .L142
 1146               	.L134:
  46:./tmk_core/common/action_tapping.c ****             // clear all in case of overflow.
 1147               		.loc 1 46 9 is_stmt 1 view .LVU277
 1148 0048 86E0      		ldi r24,lo8(6)
 1149 004a FE01      		movw r30,r28
 1150 004c 3796      		adiw r30,7
 1151 004e DE01      		movw r26,r28
 1152 0050 1196      		adiw r26,1
 1153               		0:
 1154 0052 0190      		ld r0,Z+
 1155 0054 0D92      		st X+,r0
 1156 0056 8A95      		dec r24
 1157 0058 01F4      		brne 0b
 1158               	.LVL68:
  46:./tmk_core/common/action_tapping.c ****             // clear all in case of overflow.
 1159               		.loc 1 46 9 is_stmt 0 view .LVU278
 1160 005a 6A85      		ldd r22,Y+10
 1161 005c 7B85      		ldd r23,Y+11
 1162               	.LVL69:
 1163               	.LBB58:
 1164               	.LBI58:
 293:./tmk_core/common/action_tapping.c **** {
 1165               		.loc 1 293 6 is_stmt 1 view .LVU279
 1166               	.LBB59:
 295:./tmk_core/common/action_tapping.c ****         return true;
 1167               		.loc 1 295 5 view .LVU280
 1168               	.LBB60:
 1169               	.LBI60:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1170               		.loc 2 49 20 view .LVU281
 1171               	.LBB61:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1172               		.loc 2 49 51 view .LVU282
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1173               		.loc 2 49 74 is_stmt 0 view .LVU283
 1174 005e 6115      		cp r22,__zero_reg__
 1175 0060 7105      		cpc r23,__zero_reg__
 1176 0062 01F0      		breq .L135
 1177 0064 5F81      		ldd r21,Y+7
 1178 0066 4885      		ldd r20,Y+8
 1179 0068 842F      		mov r24,r20
 1180 006a 8523      		and r24,r21
 1181 006c 8F3F      		cpi r24,lo8(-1)
 1182 006e 01F0      		breq .L135
 1183               	.LBE61:
 1184               	.LBE60:
 299:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1185               		.loc 1 299 5 is_stmt 1 view .LVU284
 299:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1186               		.loc 1 299 30 is_stmt 0 view .LVU285
 1187 0070 2091 0000 		lds r18,waiting_buffer_head
 1188 0074 30E0      		ldi r19,0
 1189 0076 C901      		movw r24,r18
 1190 0078 0196      		adiw r24,1
 299:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1191               		.loc 1 299 35 view .LVU286
 1192 007a 8770      		andi r24,7
 1193 007c 9927      		clr r25
 299:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1194               		.loc 1 299 57 view .LVU287
 1195 007e E091 0000 		lds r30,waiting_buffer_tail
 299:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1196               		.loc 1 299 8 view .LVU288
 1197 0082 E817      		cp r30,r24
 1198 0084 1906      		cpc __zero_reg__,r25
 1199 0086 01F4      		brne .L159
 1200               	.LVL70:
 299:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1201               		.loc 1 299 8 view .LVU289
 1202               	.LBE59:
 1203               	.LBE58:
 1204               	.LBB63:
  48:./tmk_core/common/action_tapping.c ****             clear_keyboard();
 1205               		.loc 1 48 50 is_stmt 1 view .LVU290
  49:./tmk_core/common/action_tapping.c ****             waiting_buffer_clear();
 1206               		.loc 1 49 13 view .LVU291
 1207 0088 0E94 0000 		call clear_keyboard
 1208               	.LVL71:
  50:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1209               		.loc 1 50 13 view .LVU292
 1210               	.LBB64:
 1211               	.LBI64:
 311:./tmk_core/common/action_tapping.c **** {
 1212               		.loc 1 311 6 view .LVU293
 1213               	.LBB65:
 313:./tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 1214               		.loc 1 313 5 view .LVU294
 313:./tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 1215               		.loc 1 313 25 is_stmt 0 view .LVU295
 1216 008c 1092 0000 		sts waiting_buffer_head,__zero_reg__
 314:./tmk_core/common/action_tapping.c **** }
 1217               		.loc 1 314 5 is_stmt 1 view .LVU296
 314:./tmk_core/common/action_tapping.c **** }
 1218               		.loc 1 314 25 is_stmt 0 view .LVU297
 1219 0090 1092 0000 		sts waiting_buffer_tail,__zero_reg__
 1220               	.LBE65:
 1221               	.LBE64:
  51:./tmk_core/common/action_tapping.c ****         }
 1222               		.loc 1 51 13 is_stmt 1 view .LVU298
  51:./tmk_core/common/action_tapping.c ****         }
 1223               		.loc 1 51 25 is_stmt 0 view .LVU299
 1224 0094 86E0      		ldi r24,lo8(6)
 1225 0096 E0E0      		ldi r30,lo8(tapping_key)
 1226 0098 F0E0      		ldi r31,hi8(tapping_key)
 1227 009a DF01      		movw r26,r30
 1228               		0:
 1229 009c 1D92      		st X+,__zero_reg__
 1230 009e 8A95      		dec r24
 1231 00a0 01F4      		brne 0b
 1232 00a2 00C0      		rjmp .L135
 1233               	.LVL72:
 1234               	.L159:
  51:./tmk_core/common/action_tapping.c ****         }
 1235               		.loc 1 51 25 view .LVU300
 1236               	.LBE63:
 1237               	.LBB66:
 1238               	.LBB62:
 304:./tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1239               		.loc 1 304 5 is_stmt 1 view .LVU301
 304:./tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1240               		.loc 1 304 41 is_stmt 0 view .LVU302
 1241 00a4 5983      		std Y+1,r21
 1242 00a6 4A83      		std Y+2,r20
 1243 00a8 7D83      		std Y+5,r23
 1244 00aa 6C83      		std Y+4,r22
 1245 00ac 96E0      		ldi r25,lo8(6)
 1246 00ae 929F      		mul r25,r18
 1247 00b0 D001      		movw r26,r0
 1248 00b2 939F      		mul r25,r19
 1249 00b4 B00D      		add r27,r0
 1250 00b6 1124      		clr __zero_reg__
 1251 00b8 A050      		subi r26,lo8(-(waiting_buffer))
 1252 00ba B040      		sbci r27,hi8(-(waiting_buffer))
 1253 00bc FE01      		movw r30,r28
 1254 00be 3196      		adiw r30,1
 1255               		0:
 1256 00c0 0190      		ld r0,Z+
 1257 00c2 0D92      		st X+,r0
 1258 00c4 9A95      		dec r25
 1259 00c6 01F4      		brne 0b
 305:./tmk_core/common/action_tapping.c **** 
 1260               		.loc 1 305 5 is_stmt 1 view .LVU303
 305:./tmk_core/common/action_tapping.c **** 
 1261               		.loc 1 305 25 is_stmt 0 view .LVU304
 1262 00c8 8093 0000 		sts waiting_buffer_head,r24
 307:./tmk_core/common/action_tapping.c ****     return true;
 1263               		.loc 1 307 34 is_stmt 1 view .LVU305
 307:./tmk_core/common/action_tapping.c ****     return true;
 1264               		.loc 1 307 36 view .LVU306
 1265 00cc 0E94 0000 		call debug_waiting_buffer
 1266               	.LVL73:
 308:./tmk_core/common/action_tapping.c **** }
 1267               		.loc 1 308 5 view .LVU307
 308:./tmk_core/common/action_tapping.c **** }
 1268               		.loc 1 308 5 is_stmt 0 view .LVU308
 1269 00d0 00C0      		rjmp .L135
 1270               	.L140:
 308:./tmk_core/common/action_tapping.c **** }
 1271               		.loc 1 308 5 view .LVU309
 1272               	.LBE62:
 1273               	.LBE66:
  60:./tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1274               		.loc 1 60 9 is_stmt 1 view .LVU310
  60:./tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1275               		.loc 1 60 13 is_stmt 0 view .LVU311
 1276 00d2 819F      		mul r24,r17
 1277 00d4 C001      		movw r24,r0
 1278 00d6 1124      		clr __zero_reg__
 1279 00d8 8050      		subi r24,lo8(-(waiting_buffer))
 1280 00da 9040      		sbci r25,hi8(-(waiting_buffer))
 1281 00dc 0E94 0000 		call process_tapping
 1282               	.LVL74:
  60:./tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1283               		.loc 1 60 12 view .LVU312
 1284 00e0 8823      		tst r24
 1285 00e2 01F0      		breq .L133
  61:./tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
 1286               		.loc 1 61 48 is_stmt 1 view .LVU313
  61:./tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
 1287               		.loc 1 61 80 view .LVU314
  61:./tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
 1288               		.loc 1 61 95 view .LVU315
  62:./tmk_core/common/action_tapping.c ****         } else {
 1289               		.loc 1 62 13 view .LVU316
 1290 00e4 E091 0000 		lds r30,waiting_buffer_tail
 1291 00e8 1E9F      		mul r17,r30
 1292 00ea F001      		movw r30,r0
 1293 00ec 1124      		clr __zero_reg__
 1294 00ee E050      		subi r30,lo8(-(waiting_buffer))
 1295 00f0 F040      		sbci r31,hi8(-(waiting_buffer))
 1296 00f2 4081      		ld r20,Z
 1297 00f4 5181      		ldd r21,Z+1
 1298 00f6 6281      		ldd r22,Z+2
 1299 00f8 7381      		ldd r23,Z+3
 1300 00fa 8481      		ldd r24,Z+4
 1301 00fc 9581      		ldd r25,Z+5
 1302 00fe 0E94 0000 		call debug_record
 1303               	.LVL75:
  62:./tmk_core/common/action_tapping.c ****         } else {
 1304               		.loc 1 62 77 view .LVU317
  59:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1305               		.loc 1 59 56 view .LVU318
  59:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1306               		.loc 1 59 99 is_stmt 0 view .LVU319
 1307 0102 8091 0000 		lds r24,waiting_buffer_tail
 1308 0106 90E0      		ldi r25,0
 1309 0108 0196      		adiw r24,1
  59:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1310               		.loc 1 59 104 view .LVU320
 1311 010a 8770      		andi r24,7
 1312 010c 9927      		clr r25
  59:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1313               		.loc 1 59 76 view .LVU321
 1314 010e 8093 0000 		sts waiting_buffer_tail,r24
 1315               	.L142:
  59:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1316               		.loc 1 59 12 is_stmt 1 discriminator 1 view .LVU322
  59:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1317               		.loc 1 59 32 is_stmt 0 discriminator 1 view .LVU323
 1318 0112 8091 0000 		lds r24,waiting_buffer_tail
  59:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1319               		.loc 1 59 5 discriminator 1 view .LVU324
 1320 0116 9091 0000 		lds r25,waiting_buffer_head
 1321 011a 8913      		cpse r24,r25
 1322 011c 00C0      		rjmp .L140
 1323               	.L133:
 1324               	/* epilogue start */
  70:./tmk_core/common/action_tapping.c **** 
 1325               		.loc 1 70 1 view .LVU325
 1326 011e 2C96      		adiw r28,12
 1327 0120 0FB6      		in __tmp_reg__,__SREG__
 1328 0122 F894      		cli
 1329 0124 DEBF      		out __SP_H__,r29
 1330 0126 0FBE      		out __SREG__,__tmp_reg__
 1331 0128 CDBF      		out __SP_L__,r28
 1332 012a DF91      		pop r29
 1333 012c CF91      		pop r28
 1334 012e 1F91      		pop r17
 1335 0130 0895      		ret
 1336               	.L157:
  43:./tmk_core/common/action_tapping.c ****         }
 1337               		.loc 1 43 33 is_stmt 1 view .LVU326
  43:./tmk_core/common/action_tapping.c ****         }
 1338               		.loc 1 43 35 view .LVU327
 1339 0132 6985      		ldd r22,Y+9
 1340 0134 7A85      		ldd r23,Y+10
 1341 0136 8B85      		ldd r24,Y+11
 1342 0138 9C85      		ldd r25,Y+12
 1343 013a 0E94 0000 		call debug_record
 1344               	.LVL76:
 1345 013e 00C0      		rjmp .L135
 1346               		.cfi_endproc
 1347               	.LFE4:
 1349               		.section	.bss.waiting_buffer_tail,"aw",@nobits
 1352               	waiting_buffer_tail:
 1353 0000 00        		.zero	1
 1354               		.section	.bss.waiting_buffer_head,"aw",@nobits
 1357               	waiting_buffer_head:
 1358 0000 00        		.zero	1
 1359               		.section	.bss.waiting_buffer,"aw",@nobits
 1362               	waiting_buffer:
 1363 0000 0000 0000 		.zero	48
 1363      0000 0000 
 1363      0000 0000 
 1363      0000 0000 
 1363      0000 0000 
 1364               		.section	.bss.tapping_key,"aw",@nobits
 1367               	tapping_key:
 1368 0000 0000 0000 		.zero	6
 1368      0000 
 1369               		.text
 1370               	.Letext0:
 1371               		.file 3 "/opt/homebrew/Cellar/avr-gcc@9/9.3.0_3/avr/include/stdint.h"
 1372               		.file 4 "./tmk_core/common/keycode.h"
 1373               		.file 5 "./tmk_core/common/action_code.h"
 1374               		.file 6 "./tmk_core/common/action.h"
 1375               		.file 7 "./tmk_core/common/action_layer.h"
 1376               		.file 8 "./tmk_core/common/timer.h"
 1377               		.file 9 "./tmk_core/common/debug.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 action_tapping.c
/var/folders/0z/ym_gdwfd5tg7m49f_1nfh8300000gn/T//ccGFAhu8.s:2      *ABS*:000000000000003e __SP_H__
/var/folders/0z/ym_gdwfd5tg7m49f_1nfh8300000gn/T//ccGFAhu8.s:3      *ABS*:000000000000003d __SP_L__
/var/folders/0z/ym_gdwfd5tg7m49f_1nfh8300000gn/T//ccGFAhu8.s:4      *ABS*:000000000000003f __SREG__
/var/folders/0z/ym_gdwfd5tg7m49f_1nfh8300000gn/T//ccGFAhu8.s:5      *ABS*:0000000000000000 __tmp_reg__
/var/folders/0z/ym_gdwfd5tg7m49f_1nfh8300000gn/T//ccGFAhu8.s:6      *ABS*:0000000000000001 __zero_reg__
/var/folders/0z/ym_gdwfd5tg7m49f_1nfh8300000gn/T//ccGFAhu8.s:12     .text.debug_waiting_buffer:0000000000000000 debug_waiting_buffer
/var/folders/0z/ym_gdwfd5tg7m49f_1nfh8300000gn/T//ccGFAhu8.s:1352   .bss.waiting_buffer_tail:0000000000000000 waiting_buffer_tail
/var/folders/0z/ym_gdwfd5tg7m49f_1nfh8300000gn/T//ccGFAhu8.s:1357   .bss.waiting_buffer_head:0000000000000000 waiting_buffer_head
/var/folders/0z/ym_gdwfd5tg7m49f_1nfh8300000gn/T//ccGFAhu8.s:1362   .bss.waiting_buffer:0000000000000000 waiting_buffer
/var/folders/0z/ym_gdwfd5tg7m49f_1nfh8300000gn/T//ccGFAhu8.s:95     .text.debug_tapping_key:0000000000000000 debug_tapping_key
/var/folders/0z/ym_gdwfd5tg7m49f_1nfh8300000gn/T//ccGFAhu8.s:1367   .bss.tapping_key:0000000000000000 tapping_key
/var/folders/0z/ym_gdwfd5tg7m49f_1nfh8300000gn/T//ccGFAhu8.s:118    .text.waiting_buffer_scan_tap:0000000000000000 waiting_buffer_scan_tap
/var/folders/0z/ym_gdwfd5tg7m49f_1nfh8300000gn/T//ccGFAhu8.s:299    .text.process_tapping:0000000000000000 process_tapping
/var/folders/0z/ym_gdwfd5tg7m49f_1nfh8300000gn/T//ccGFAhu8.s:1075   .text.action_tapping_process:0000000000000000 action_tapping_process

UNDEFINED SYMBOLS
debug_record
process_record
layer_switch_get_action
is_tap_key
debug_event
clear_keyboard
__do_clear_bss
